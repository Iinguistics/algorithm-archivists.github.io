
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Graham Scan Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../chan/chans.html" />
    
    
    <link rel="prev" href="../jarvis_march/jarvis_march.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../../">
            
                <a href="../../../../">
            
                    
                    README
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../../TODO.html">
            
                <a href="../../../../TODO.html">
            
                    
                    TODO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../../introduction.html">
            
                <a href="../../../introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../getting_started.html">
            
                <a href="../../../getting_started.html">
            
                    
                    A Personal Note
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../../how_to_contribute.html">
            
                <a href="../../../how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../../principles_of_code/principles_of_code.html">
            
                <a href="../../../principles_of_code/principles_of_code.html">
            
                    
                    Principles of Code
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../../principles_of_code/choosing_a_language/choosing_a_language.html">
            
                <a href="../../../principles_of_code/choosing_a_language/choosing_a_language.html">
            
                    
                    Choosing A Language
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../../../principles_of_code/choosing_a_language/compiled/compiled.html">
            
                <a href="../../../principles_of_code/choosing_a_language/compiled/compiled.html">
            
                    
                    Compiled Languages
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1.1" data-path="../../../principles_of_code/choosing_a_language/compiled/makefiles.html">
            
                <a href="../../../principles_of_code/choosing_a_language/compiled/makefiles.html">
            
                    
                    Makefiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.1.2" data-path="../../../principles_of_code/choosing_a_language/compiled/FORTRAN.html">
            
                <a href="../../../principles_of_code/choosing_a_language/compiled/FORTRAN.html">
            
                    
                    FORTRAN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../../principles_of_code/building_blocks/building_blocks.html">
            
                <a href="../../../principles_of_code/building_blocks/building_blocks.html">
            
                    
                    Building Blocks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../../../principles_of_code/building_blocks/variables.html">
            
                <a href="../../../principles_of_code/building_blocks/variables.html">
            
                    
                    Variables and Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="../../../principles_of_code/building_blocks/conditions.html">
            
                <a href="../../../principles_of_code/building_blocks/conditions.html">
            
                    
                    Conditions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="../../../principles_of_code/building_blocks/loops.html">
            
                <a href="../../../principles_of_code/building_blocks/loops.html">
            
                    
                    Loops
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="../../../principles_of_code/building_blocks/functions.html">
            
                <a href="../../../principles_of_code/building_blocks/functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="../../../principles_of_code/building_blocks/classes.html">
            
                <a href="../../../principles_of_code/building_blocks/classes.html">
            
                    
                    Classes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="../../../principles_of_code/building_blocks/stacks.html">
            
                <a href="../../../principles_of_code/building_blocks/stacks.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.7" data-path="../../../principles_of_code/building_blocks/bitlogic.html">
            
                <a href="../../../principles_of_code/building_blocks/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../../principles_of_code/version_control.html">
            
                <a href="../../../principles_of_code/version_control.html">
            
                    
                    Version Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../../../principles_of_code/notation/notation.html">
            
                <a href="../../../principles_of_code/notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../../convolutions/convolutions.html">
            
                <a href="../../../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../../taylor/taylor_series.html">
            
                <a href="../../../taylor/taylor_series.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../../sorting_searching/sorting_searching.html">
            
                <a href="../../../sorting_searching/sorting_searching.html">
            
                    
                    Sorting and Searching
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../../sorting_searching/bubble/bubble_sort.html">
            
                <a href="../../../sorting_searching/bubble/bubble_sort.html">
            
                    
                    Bubble Sort
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../../../sorting_searching/bogo/bogo_sort.html">
            
                <a href="../../../sorting_searching/bogo/bogo_sort.html">
            
                    
                    Bogo Sort
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../../tree_traversal/tree_traversal.html">
            
                <a href="../../../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../../../euclidean_algorithm/euclidean.html">
            
                <a href="../../../euclidean_algorithm/euclidean.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../../../multiplication/multiplication.html">
            
                <a href="../../../multiplication/multiplication.html">
            
                    
                    Multiplication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../../../matrix_methods/matrix_methods.html">
            
                <a href="../../../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../../../matrix_methods/gaussian_elimination/gaussian_elimination.html">
            
                <a href="../../../matrix_methods/gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../../../matrix_methods/thomas/thomas.html">
            
                <a href="../../../matrix_methods/thomas/thomas.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../../computational_geometry.html">
            
                <a href="../../computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../gift_wrapping.html">
            
                <a href="../gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.14.1.2" data-path="graham_scan.html">
            
                <a href="graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.1.3" data-path="../chan/chans.html">
            
                <a href="../chan/chans.html">
            
                    
                    Chan's Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../../../FFT/cooley_tukey.html">
            
                <a href="../../../FFT/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../../../decision_problems/decision_problems.html">
            
                <a href="../../../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../../../decision_problems/stable_marriage/stable_marriage.html">
            
                <a href="../../../decision_problems/stable_marriage/stable_marriage.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../../../differential_equations/differential_equations.html">
            
                <a href="../../../differential_equations/differential_equations.html">
            
                    
                    Differential Equation Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../../../differential_equations/euler/euler.html">
            
                <a href="../../../differential_equations/euler/euler.html">
            
                    
                    Forward Euler Method
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="../../../differential_equations/euler/backward_euler.html">
            
                <a href="../../../differential_equations/euler/backward_euler.html">
            
                    
                    Backward Euler Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.3" data-path="../../../differential_equations/runge_kutta/runge_kutta.html">
            
                <a href="../../../differential_equations/runge_kutta/runge_kutta.html">
            
                    
                    Runge Kutta
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../../../physics_solvers/physics_solvers.html">
            
                <a href="../../../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../../../physics_solvers/verlet/verlet.html">
            
                <a href="../../../physics_solvers/verlet/verlet.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../../../physics_solvers/barnes_hut.html">
            
                <a href="../../../physics_solvers/barnes_hut.html">
            
                    
                    Barnes-Hut
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.3" data-path="../../../physics_solvers/quantum/quantum.html">
            
                <a href="../../../physics_solvers/quantum/quantum.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../../../data_compression/data_compression.html">
            
                <a href="../../../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="../../../data_compression/huffman/huffman.html">
            
                <a href="../../../data_compression/huffman/huffman.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../../../QI/QI.html">
            
                <a href="../../../QI/QI.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../.." >Graham Scan</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p><script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>
<script type="math/tex; "> 
\newcommand{\d}{\mathrm{d}}
\newcommand{\bff}{\boldsymbol{f}}
\newcommand{\bfg}{\boldsymbol{g}}
\newcommand{\bfp}{\boldsymbol{p}}
\newcommand{\bfq}{\boldsymbol{q}}
\newcommand{\bfx}{\boldsymbol{x}}
\newcommand{\bfu}{\boldsymbol{u}}
\newcommand{\bfv}{\boldsymbol{v}}
\newcommand{\bfA}{\boldsymbol{A}}
\newcommand{\bfB}{\boldsymbol{B}}
\newcommand{\bfC}{\boldsymbol{C}}
\newcommand{\bfM}{\boldsymbol{M}}
\newcommand{\bfJ}{\boldsymbol{J}}
\newcommand{\bfR}{\boldsymbol{R}}
\newcommand{\bfT}{\boldsymbol{T}}
\newcommand{\bfomega}{\boldsymbol{\omega}}
\newcommand{\bftau}{\boldsymbol{\tau}}
</script></p>
<h1 id="graham-scan">Graham Scan</h1>
<p>At around the same time of the <a href="jarvis_march.md">Jarvis March</a>, R. L. Graham was also developing an algorithm to find the convex hull of a random set of points <a href="#cite-1">[1]</a>.
Unlike the Jarvis March, which is an <script type="math/tex; ">\mathcal{O}(nh)</script> operation, the Graham Scan is <script type="math/tex; ">\mathcal{O}(n\log(n))</script>, where <script type="math/tex; ">n</script> is the number of points and <script type="math/tex; ">h</script> is the size fo the hull. 
This means that the complexity of the Graham Scan is not output-sensitive; moreover, there are some cases where the Jarvis March is more optimal, depending on the size of the hull and the number of points to wrap.</p>
<p>Rather than starting at the leftmost point like the Jarvis March, the Graham scan starts at the bottom. 
We then sort the distribution of points based on the angle between the bottom-most point, the origin, and each other point.
After sorting, we go through point-by-point, searching for points that are on the convex hull and throwing out any other points.
We do this by looking for counter-clockwise rotations.
If an angle between three points turns inward, the shape is obviously not convex, so we can throw that result out.
We can find whether a rotation is counter-clockwise with trigonometric functions or by using a cross-product, like so:</p>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> ccw(a<span class="hljs-type">::</span>Point, b<span class="hljs-type">::</span>Point, c<span class="hljs-type">::</span>Point)
    <span class="hljs-keyword">return</span> ((b.x - a.x)*(c.y - a.y) - (b.y - a.y)*(c.x - a.x))
<span class="hljs-keyword">end</span>
</code></pre>
</div></div></div>

<p>If the output of this function is 0, the points are collinear.
If the output is positive, then the points form a counter-clockwise &quot;left&quot; turn.
If the output is negative, then the points form a clockwise &quot;right&quot; turn.
We basically do not want clockwise rotations, because this means we are at an interior angle.</p>
<!---ADD FIGURE--->
<p>To save memory and expensive <code>append()</code> operations, we ultimately look for points that should be on the hull and swap them with the first elements in the array.
If there are <script type="math/tex; ">M</script> elements on the hull, then the first <script type="math/tex; ">M</script> elements in our output random distribution of points will be the hull. 
In the end, the code should look something like this:</p>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> graham_scan(points<span class="hljs-type">::</span><span class="hljs-built_in">Vector</span>{Point})
    N = length(points)

    <span class="hljs-comment"># Place the lowest point at the start of the array</span>
    sort!(points, by = item -&gt; item.y)

    <span class="hljs-comment"># Sort all other points according to angle with that point</span>
    other_points = sort(points[<span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>], by = item -&gt; graham_angle(Point(points[<span class="hljs-number">1</span>].x - <span class="hljs-number">1</span>,points[<span class="hljs-number">1</span>].y), points[<span class="hljs-number">1</span>], item))

    <span class="hljs-comment"># Place points sorted by angle back into points vector</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(other_points)
        points[i+<span class="hljs-number">1</span>] = other_points[i]
    <span class="hljs-keyword">end</span>

    <span class="hljs-comment"># M will be the point on the hull</span>
    M = <span class="hljs-number">2</span>
    i = <span class="hljs-number">3</span>
    <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:N
        <span class="hljs-keyword">while</span> (ccw(points[M-<span class="hljs-number">1</span>], points[M], points[i]) &lt;= <span class="hljs-number">0</span>)
            <span class="hljs-keyword">if</span> (M &gt; <span class="hljs-number">2</span>)
                M -= <span class="hljs-number">1</span>
            <span class="hljs-comment"># All points are collinear</span>
            <span class="hljs-keyword">elseif</span> (i == N)
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">else</span>
                i += <span class="hljs-number">1</span>
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>

        <span class="hljs-comment"># ccw point found, updating hull and swapping points</span>
        M += <span class="hljs-number">1</span>
        points[i], points[M] = points[M], points[i]
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> points[<span class="hljs-number">1</span>:M]
<span class="hljs-keyword">end</span>
</code></pre>
</div></div></div>

<h3 id="bibliography">Bibliography</h3>
<p><table class="references"><tr><td><span class="citation-number" id="cite-1">1</span></td><td>Graham, Ronald L, An efficient algorithm for determining the convex hull of a finite planar set, <i>Elsevier</i>, 1972.</td></tr></table></p>
<h3 id="example-code">Example Code</h3>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">type</span> Point
    x<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>
    y<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> dist(point1<span class="hljs-type">::</span>Point, point2<span class="hljs-type">::</span>Point)
    <span class="hljs-keyword">return</span> sqrt((point1.x - point2.x)^<span class="hljs-number">2</span> + (point1.y - point2.y)^<span class="hljs-number">2</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> graham_angle(point1<span class="hljs-type">::</span>Point, point2<span class="hljs-type">::</span>Point, point3<span class="hljs-type">::</span>Point)
    <span class="hljs-comment"># Find distances between all points</span>
    a = dist(point3, point2)
    b = dist(point3, point1)
    c = dist(point1, point2)

    ret_angle = acos((b*b - a*a - c*c)/(<span class="hljs-number">2</span>*a*c))

    <span class="hljs-keyword">if</span>(sign(point1.x - point2.x) != sign(point1.x - point3.x))
        ret_angle += <span class="hljs-number">0.5</span>*<span class="hljs-literal">pi</span>
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">if</span> (isnan(ret_angle))
        exit(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> ret_angle

<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> ccw(a<span class="hljs-type">::</span>Point, b<span class="hljs-type">::</span>Point, c<span class="hljs-type">::</span>Point)
    <span class="hljs-keyword">return</span> ((b.x - a.x)*(c.y - a.y) - (b.y - a.y)*(c.x - a.x))
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> graham_scan(points<span class="hljs-type">::</span><span class="hljs-built_in">Vector</span>{Point})
    N = length(points)

    <span class="hljs-comment"># Place the lowest point at the start of the array</span>
    sort!(points, by = item -&gt; item.y)

    <span class="hljs-comment"># Sort all other points according to angle with that point</span>
    other_points = sort(points[<span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>], by = item -&gt; graham_angle(Point(points[<span class="hljs-number">1</span>].x - <span class="hljs-number">1</span>,points[<span class="hljs-number">1</span>].y), points[<span class="hljs-number">1</span>], item))

    <span class="hljs-comment"># Place points sorted by angle back into points vector</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(other_points)
        points[i+<span class="hljs-number">1</span>] = other_points[i]
    <span class="hljs-keyword">end</span>

    <span class="hljs-comment"># M will be the point on the hull</span>
    M = <span class="hljs-number">2</span>
    i = <span class="hljs-number">3</span>
    <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:N
        <span class="hljs-keyword">while</span> (ccw(points[M-<span class="hljs-number">1</span>], points[M], points[i]) &lt;= <span class="hljs-number">0</span>)
            <span class="hljs-keyword">if</span> (M &gt; <span class="hljs-number">2</span>)
                M -= <span class="hljs-number">1</span>
            <span class="hljs-comment"># All points are collinear</span>
            <span class="hljs-keyword">elseif</span> (i == N)
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">else</span>
                i += <span class="hljs-number">1</span>
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>

        <span class="hljs-comment"># ccw point found, updating hull and swapping points</span>
        M += <span class="hljs-number">1</span>
        points[i], points[M] = points[M], points[i]
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> points[<span class="hljs-number">1</span>:M]
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> main()
    points = [Point(<span class="hljs-number">2</span>,<span class="hljs-number">1.9</span>), Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), Point(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>), Point(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), Point(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>)]
    hull = graham_scan(points)
    println(hull)
<span class="hljs-keyword">end</span>

main()
</code></pre>
</div></div></div>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Graham Scan","level":"1.14.1.2","depth":3,"next":{"title":"Chan's Algorithm","level":"1.14.1.3","depth":3,"path":"chapters/computational_geometry/gift_wrapping/chan/chans.md","ref":"chapters/computational_geometry/gift_wrapping/chan/chans.md","articles":[]},"previous":{"title":"Jarvis March","level":"1.14.1.1","depth":3,"path":"chapters/computational_geometry/gift_wrapping/jarvis_march/jarvis_march.md","ref":"chapters/computational_geometry/gift_wrapping/jarvis_march/jarvis_march.md","articles":[]},"dir":"ltr"},"config":{"plugins":["mathjax","bibtex-cite","creativecommons","wordcount","theme-api","include-codeblock"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"theme-api":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"pseudo","name":"Pseudocode"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"py2","name":"Python 2"},{"lang":"py3","name":"Python 3"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"}],"split":false,"theme":"light"},"bibtex-cite":{},"creativecommons":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}}],"gitbook":"3.x.x"},"file":{"path":"chapters/computational_geometry/gift_wrapping/graham_scan/graham_scan.md","mtime":"2018-04-25T21:50:12.640Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-04-27T21:36:44.567Z"},"basePath":"../../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../../gitbook/gitbook.js"></script>
    <script src="../../../../gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    

    </body>
</html>

