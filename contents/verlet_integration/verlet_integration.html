
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Verlet Integration Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../quantum_systems/quantum_systems.html" />
    
    
    <link rel="prev" href="../physics_solvers/physics_solvers.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../convolutions/convolutions.html">
            
                <a href="../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../sorting_and_searching/sorting_and_searching.html">
            
                <a href="../sorting_and_searching/sorting_and_searching.html">
            
                    
                    Sorting and Searching
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../bubble_sort/bubble_sort.html">
            
                <a href="../bubble_sort/bubble_sort.html">
            
                    
                    Bubble Sort
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../bogo_sort/bogo_sort.html">
            
                <a href="../bogo_sort/bogo_sort.html">
            
                    
                    Bogo Sort
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="../gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="../thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="../cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../differential_equations/differential_equations.html">
            
                <a href="../differential_equations/differential_equations.html">
            
                    
                    Differential Equation Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../forward_euler_method/forward_euler_method.html">
            
                <a href="../forward_euler_method/forward_euler_method.html">
            
                    
                    Forward Euler Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.15.1" data-path="verlet_integration.html">
            
                <a href="verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Verlet Integration</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="verlet-integration">Verlet Integration</h1>
<p>Verlet integration is essentially a solution to the kinematic equation for the motion of any object,</p>
<p><script type="math/tex; mode=display">
x = x_0 + v_0t + \frac{1}{2}at^2 + \frac{1}{6}bt^3 + \cdots
</script></p>
<p>where <script type="math/tex; ">x</script> is the position, <script type="math/tex; ">v</script> is the velocity, <script type="math/tex; ">a</script> is the acceleration, <script type="math/tex; ">b</script> is the often forgotten jerk term, and <script type="math/tex; ">t</script> is time. This equation is a central equation to almost every Newtonian physics solver and brings up a class of algorithms known as <em>force integrators</em>. One of the first force integrators to work with is <em>Verlet Integration</em>.</p>
<p>So, let&apos;s say we want to solve for the next timestep in <script type="math/tex; ">x</script>. To a close approximation (actually performing a Taylor Series Expansion about <script type="math/tex; ">x(t\pm \Delta t)</script>), that might look like this:</p>
<p><script type="math/tex; mode=display">
x(t+\Delta t) = x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 + \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>This means that if we need to find the next <script type="math/tex; ">x</script>, we need the current <script type="math/tex; ">x</script>, <script type="math/tex; ">v</script>, <script type="math/tex; ">a</script>, etc. However, because few people calculate the jerk term, our error is typically <script type="math/tex; ">\mathcal{O}(\Delta t^3)</script>. That said, we can calculate <script type="math/tex; ">x</script> with less knowledge and higher accuracy if we play a trick! Let&apos;s say we want to calculate <script type="math/tex; ">x</script> of the <em>previous</em> timestep. Again, to a close approximation, that might look like this:</p>
<p><script type="math/tex; mode=display">
x(t-\Delta t) = x(t) - v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 - \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>Now, we have two equations to solve for two different timesteps in x, one of which we already have. If we add the two equations together and solve for <script type="math/tex; ">x(t+\Delta t)</script>, we find that</p>
<p><script type="math/tex; mode=display">
x(t+ \Delta t) = 2x(t) - x(t-\Delta t) + a(t)\Delta t^2 + \mathcal{O}(\Delta t^4)
</script></p>
<p>So, this means we can find our next <script type="math/tex; ">x</script> simply by knowing our current <script type="math/tex; ">x</script>, the <script type="math/tex; ">x</script> before that, and the acceleration! No velocity necessary! In addition, this drops the error to <script type="math/tex; ">\mathcal{O}(\Delta t^4)</script>, which is great!
Here is what it looks like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> prev_pos = pos;
  <span class="hljs-keyword">double</span> time = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    <span class="hljs-keyword">double</span> next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = pos;
    pos = next_pos;
  }

  <span class="hljs-keyword">return</span> time;
}
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> *time, <span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos;
    prev_pos = pos;
    *time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        *time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }
}
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
  <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
  prev_pos = pos;
  time = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    <span class="hljs-keyword">return</span> time;
}
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verlet</span><span class="hljs-params">(pos, acc, dt)</span>:</span>
    prev_pos = pos
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span>:
        time += dt
        next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos, pos = pos, next_pos

    <span class="hljs-keyword">return</span> time
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre><code class="lang-haskell"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Method</span> = <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Time</span> -&gt; <span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Particle</span></span>

<span class="hljs-title">verlet</span> :: <span class="hljs-type">Method</span>
<span class="hljs-title">verlet</span> acc dt (xOld, _, _, _) (x, _, a, t) = (x&apos;, v&apos;, a&apos;, t + dt)
  <span class="hljs-keyword">where</span>
    x&apos; = <span class="hljs-number">2</span> * x - xOld + a * dt ^ <span class="hljs-number">2</span>
    v&apos; = <span class="hljs-number">0</span>
    a&apos; = acc (x&apos;, v&apos;, a, t + dt)
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verlet</span>(<span class="hljs-params">pos, acc, dt</span>) </span>{
  <span class="hljs-keyword">let</span> prevPos = pos;
  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> tempPos;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    tempPos = pos;
    pos = pos * <span class="hljs-number">2</span> - prevPos + acc * dt * dt;
    prevPos = tempPos;
  }

  <span class="hljs-keyword">return</span> time;
}
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) -&gt; <span class="hljs-keyword">f64</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    time
}
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">verlet</span><span class="hljs-params">(pos: Double, acc: Double, dt: Double)</span></span> -&gt; <span class="hljs-type">Double</span> {
    <span class="hljs-keyword">var</span> pos = pos
    <span class="hljs-keyword">var</span> temp_pos, time: <span class="hljs-type">Double</span>
    <span class="hljs-keyword">var</span> prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    }

    <span class="hljs-keyword">return</span> time
}
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre><code class="lang-fortran"><span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> verlet(pos, acc, dt, time) 
    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span>
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos


    prev_pos = pos
    time     = <span class="hljs-number">0d0</span>

    <span class="hljs-keyword">DO</span>
        <span class="hljs-keyword">IF</span> (pos &gt; <span class="hljs-number">0d0</span>) <span class="hljs-keyword">THEN</span>
            time     = time + dt
            next_pos = pos * <span class="hljs-number">2d0</span> - prev_pos + acc * dt ** <span class="hljs-number">2</span>
            prev_pos = pos
            pos      = next_pos
        <span class="hljs-keyword">ELSE</span>
            <span class="hljs-keyword">EXIT</span>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">DO</span>
<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> verlet
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre><code class="lang-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verlet</span><span class="hljs-params">(pos, acc, dt)</span></span>

    prev_pos = pos
    time = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

   <span class="hljs-keyword">return</span> time

<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre><code class="lang-go"><span class="hljs-keyword">func</span> verlet(pos, acc, dt <span class="hljs-keyword">float64</span>) (time <span class="hljs-keyword">float64</span>) {
    prevPos := pos
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">for</span> pos &gt; <span class="hljs-number">0</span> {
        time += dt
        nextPos := pos*<span class="hljs-number">2</span> - prevPos + acc*dt*dt
        prevPos, pos = pos, nextPos
    }

    <span class="hljs-keyword">return</span>
}
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre><code class="lang-asm-x64"># xmm0 - pos
# xmm1 - acc
# xmm2 - dt
# RET xmm0 - time
verlet:
  pxor   xmm7, xmm7                  # Holds 0 for comparisons
  pxor   xmm3, xmm3                  # Holds time value
  comisd xmm0, xmm7                  # Check if pos is greater then 0.0
  jbe    verlet_return
  movsd  xmm6, xmm1                  # xmm6 = acc * dt * dt
  mulsd  xmm6, xmm2
  mulsd  xmm6, xmm2
  movsd  xmm5, xmm0                  # Holds previous position
verlet_loop:
  addsd  xmm3, xmm2                  # Adding dt to time
  movsd  xmm4, xmm0                  # Hold old value of posistion
  addsd  xmm0, xmm0                  # Calculating new position
  subsd  xmm0, xmm5
  addsd  xmm0, xmm6
  movsd  xmm5, xmm4
  comisd xmm0, xmm7                  # Check if position is greater then 0.0
  ja     verlet_loop
verlet_return:
  movsd  xmm0, xmm3                  # Saving time value
  ret
</code></pre>
</div></div></div>

<p>Now, obviously this poses a problem; what if we want to calculate a term that requires velocity, like the kinetic energy, <script type="math/tex; ">\frac{1}{2}mv^2</script>? In this case, we certainly cannot get rid of the velocity! Well, we can find the velocity to <script type="math/tex; ">\mathcal{O}(\Delta t^2)</script> accuracy by using the Stormer-Verlet method, which is the same as before, but we calculate velocity like so</p>
<p><script type="math/tex; mode=display">
v(t) = \frac{x(t+\Delta t) - x(t-\Delta t)}{2\Delta t} + \mathcal{O}(\Delta t^2)
</script></p>
<p>Note that the 2 in the denominator appears because we are going over 2 timesteps. It&apos;s essentially solving <script type="math/tex; ">v=\frac{\Delta x}{\Delta t}</script>. In addition, we can calculate the velocity of the next timestep like so</p>
<p><script type="math/tex; mode=display">
v(t+\Delta t) = \frac{x(t+\Delta t) - x(t)}{\Delta t} + \mathcal{O}(\Delta t)
</script></p>
<p>However, the error for this is <script type="math/tex; ">\mathcal{O}(\Delta t)</script>, which is quite poor, but it gets the job done in a pinch.  Here&apos;s what it looks like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc * dt
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-function">timestep <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> prev_pos = pos;
  <span class="hljs-keyword">double</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">double</span> vel = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    <span class="hljs-keyword">double</span> next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = pos;
    pos = next_pos;

    <span class="hljs-comment">// The acceleration is constant, so the velocity is</span>
    <span class="hljs-comment">// straightforward</span>
    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> timestep { time, vel };
}
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> *time, <span class="hljs-keyword">double</span> *vel,
                    <span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos;
    prev_pos = pos;
    *vel = <span class="hljs-number">0.0</span>;
    *time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        *time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        *vel += acc * dt;
    }
}
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">static</span> VerletValues <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        <span class="hljs-comment">// The acceleration is constant, so the velocity is straightforward</span>
         vel += acc*dt;
    }

   VerletValues stormerVerlet = <span class="hljs-keyword">new</span> VerletValues(time, vel);
   <span class="hljs-keyword">return</span> stormerVerlet;
}
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(pos, acc, dt)</span>:</span>
    prev_pos = pos
    time = <span class="hljs-number">0</span>
    vel = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span>:
        time += dt
        next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos, pos = pos, next_pos
        vel += acc * dt

    <span class="hljs-keyword">return</span> time, vel
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre><code class="lang-haskell"><span class="hljs-title">stormerVerlet</span> :: <span class="hljs-type">Method</span>
<span class="hljs-title">stormerVerlet</span> acc dt (xOld, _, _, _) (x, _, a, t) = (x&apos;, v&apos;, a&apos;, t + dt)
  <span class="hljs-keyword">where</span>
    x&apos; = <span class="hljs-number">2</span> * x - xOld + a * dt ^ <span class="hljs-number">2</span>
    v&apos; = (x&apos; - x) / dt
    a&apos; = acc (x&apos;, v&apos;, a, t + dt)
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc * dt
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc * dt
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc * dt
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stormerVerlet</span>(<span class="hljs-params">pos, acc, dt</span>) </span>{
  <span class="hljs-keyword">let</span> prevPos = pos;
  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> vel = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> tempPos;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    tempPos = pos;
    pos = pos * <span class="hljs-number">2</span> - prevPos + acc * dt * dt;
    prevPos = tempPos;

    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> { time, vel };
}
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">stormer_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) -&gt; (<span class="hljs-keyword">f64</span>, <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vel = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        <span class="hljs-comment">// Because acceleration is constant, velocity is</span>
        <span class="hljs-comment">// straightforward</span>
        vel += acc * dt;
    }

    (time, vel)
}
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stormerVerlet</span><span class="hljs-params">(pos: Double, acc: Double, dt: Double)</span></span> -&gt; (time: <span class="hljs-type">Double</span>, vel: <span class="hljs-type">Double</span>) {
    <span class="hljs-keyword">var</span> pos = pos
    <span class="hljs-keyword">var</span> temp_pos, time, vel: <span class="hljs-type">Double</span>
    <span class="hljs-keyword">var</span> prev_pos = pos
    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        vel += acc*dt
    }

    <span class="hljs-keyword">return</span> (time:time, vel:vel)
}
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre><code class="lang-fortran"><span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> stormer_verlet(pos, acc, dt, time, vel) 
    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span>
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time, vel
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos

    prev_pos = pos 
    time     = <span class="hljs-number">0d0</span>
    vel      = <span class="hljs-number">0d0</span>

    <span class="hljs-keyword">DO</span>
        <span class="hljs-keyword">IF</span> (pos &gt; <span class="hljs-number">0d0</span>) <span class="hljs-keyword">THEN</span>
            time     = time + dt
            next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt ** <span class="hljs-number">2</span>
            prev_pos = pos
            pos      = next_pos
            vel      = vel + acc * dt
        <span class="hljs-keyword">ELSE</span>
            <span class="hljs-keyword">EXIT</span>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">DO</span>
<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> stormer_verlet
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre><code class="lang-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(pos, acc, dt)</span></span>

    prev_pos = pos
    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        vel += acc*dt
    <span class="hljs-keyword">end</span>

   <span class="hljs-keyword">return</span> time

<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre><code class="lang-go"><span class="hljs-keyword">func</span> stormerVerlet(pos, acc, dt <span class="hljs-keyword">float64</span>) (time, vel <span class="hljs-keyword">float64</span>) {
    prevPos := pos
    time, vel = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>

    <span class="hljs-keyword">for</span> pos &gt; <span class="hljs-number">0</span> {
        time += dt
        vel += acc * dt
        nextPos := pos*<span class="hljs-number">2</span> - prevPos + acc*dt*dt
        prevPos, pos = pos, nextPos
    }

    <span class="hljs-keyword">return</span>
}
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre><code class="lang-asm-x64"># xmm0 - pos
# xmm1 - acc
# xmm2 - dt
# RET xmm0 - time
# RET xmm1 - velocity
stormer_verlet:
  pxor   xmm7, xmm7                  # Holds 0 for comparisons
  pxor   xmm3, xmm3                  # Holds time value
  comisd xmm0, xmm7                  # Check if pos is greater then 0.0
  jbe    stormer_verlet_return
  movsd  xmm6, xmm1                  # xmm6 = acc * dt * dt
  mulsd  xmm6, xmm2
  mulsd  xmm6, xmm2
  movsd  xmm5, xmm0                  # Holds previous position
stormer_verlet_loop:
  addsd  xmm3, xmm2                  # Adding dt to time
  movsd  xmm4, xmm0                  # Hold old value of posistion
  addsd  xmm0, xmm0                  # Calculating new position
  subsd  xmm0, xmm5
  addsd  xmm0, xmm6
  movsd  xmm5, xmm4
  comisd xmm0, xmm7                  # Check if position is greater then 0.0
  ja     stormer_verlet_loop
stormer_verlet_return:
  movsd  xmm0, xmm3                  # Saving time and velocity
  mulsd  xmm3, xmm1
  movsd  xmm1, xmm3
  ret
</code></pre>
</div></div></div>


<p>Now, let&apos;s say we actually need the velocity to calculate out next timestep. Well, in this case, we simply cannot use the above approximation and instead need to use the <em>Velocity Verlet</em> algorithm.</p>
<h1 id="velocity-verlet">Velocity Verlet</h1>
<p>In some ways, this algorithm is even simpler than above. We can calculate everything like</p>
<p><script type="math/tex; mode=display">
\begin{align}
x(t+\Delta t) &=x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t) + \frac{1}{2}(a(t) + a(t+\Delta t))\Delta t
\end{align}
</script></p>
<p>which is literally the kinematic equation above, solving for <script type="math/tex; ">x</script>, <script type="math/tex; ">v</script>, and <script type="math/tex; ">a</script> every timestep. You can also split up the equations like so</p>
<p><script type="math/tex; mode=display">
\begin{align}
v(t+\frac{1}{2}\Delta t) &= v(t) + \frac{1}{2}a(t)\Delta t \\
x(t+\Delta t) &=x(t) + v(t+\frac{1}{2}\Delta t)\Delta t \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t+\frac{1}{2}\Delta t) + \frac{1}{2}a(t+\Delta t)\Delta t
\end{align}
</script></p>
<p>Here is the velocity Verlet method in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-function">timestep <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">double</span> vel = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> timestep { time, vel };
}
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> *time, <span class="hljs-keyword">double</span> *vel,
                     <span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    *vel = <span class="hljs-number">0.0</span>;
    *time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        *time += dt;
        pos += (*vel) * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        *vel += acc * dt;
    }
}
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">static</span> VerletValues <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt;
        vel += acc*dt;
  }

    VerletValues velocityVerlet = <span class="hljs-keyword">new</span> VerletValues(time, vel);
    <span class="hljs-keyword">return</span> velocityVerlet;
}
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(pos, acc, dt)</span>:</span>
    time = <span class="hljs-number">0</span>
    vel = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span>:
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt
        vel += acc * dt

    <span class="hljs-keyword">return</span> time, vel
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre><code class="lang-haskell"><span class="hljs-title">velocityVerlet</span> :: <span class="hljs-type">Method</span>
<span class="hljs-title">velocityVerlet</span> acc dt (xOld, _, aOld, _) (x, v, a, t) = (x&apos;, v&apos;, a&apos;, t + dt)
  <span class="hljs-keyword">where</span>
    x&apos; = <span class="hljs-number">2</span> * x - xOld + a * dt ^ <span class="hljs-number">2</span>
    v&apos; = v + <span class="hljs-number">0.5</span> * (aOld + a) * dt
    a&apos; = acc (x&apos;, v&apos;, a, t + dt)
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">velocityVerlet</span>(<span class="hljs-params">pos, acc, dt</span>) </span>{
  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> vel = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> { time, vel };
}
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">velocity_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) -&gt; (<span class="hljs-keyword">f64</span>, <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vel = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    }

    (time, vel)
}
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">velocityVerlet</span><span class="hljs-params">(pos: Double, acc: Double, dt: Double)</span></span> -&gt; (time: <span class="hljs-type">Double</span>, vel: <span class="hljs-type">Double</span>) {
    <span class="hljs-keyword">var</span> pos = pos
    <span class="hljs-keyword">var</span> time, vel : <span class="hljs-type">Double</span>
    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt
        vel += acc*dt
    }

    <span class="hljs-keyword">return</span> (time:time, vel:vel)
}
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre><code class="lang-fortran"><span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> velocity_verlet(pos, acc, dt, time, vel) 
    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span>
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time, vel

    time     = <span class="hljs-number">0d0</span>
    vel      = <span class="hljs-number">0d0</span>

    <span class="hljs-keyword">DO</span>
        <span class="hljs-keyword">IF</span> (pos &gt; <span class="hljs-number">0d0</span>) <span class="hljs-keyword">THEN</span>
            time = time + dt
            pos  = pos + vel * dt + <span class="hljs-number">0.5d0</span> * acc * dt ** <span class="hljs-number">2</span> 
            vel  = vel + acc * dt
        <span class="hljs-keyword">ELSE</span>
            <span class="hljs-keyword">EXIT</span>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">DO</span>
<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> velocity_verlet
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre><code class="lang-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(pos, acc, dt)</span></span>

    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>
        time += dt
        pos += vel*dt + <span class="hljs-number">0</span>.<span class="hljs-number">5</span>*acc * dt * dt
        vel += acc*dt
    <span class="hljs-keyword">end</span>

   <span class="hljs-keyword">return</span> time

<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre><code class="lang-go"><span class="hljs-keyword">func</span> velocityVerlet(pos, acc, dt <span class="hljs-keyword">float64</span>) (time, vel <span class="hljs-keyword">float64</span>) {
    time, vel = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>

    <span class="hljs-keyword">for</span> pos &gt; <span class="hljs-number">0</span> {
        time += dt
        pos += vel*dt + <span class="hljs-number">.5</span>*acc*dt*dt
        vel += acc * dt
    }

    <span class="hljs-keyword">return</span>
}
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre><code class="lang-asm-x64"># xmm0 - pos
# xmm1 - acc
# xmm2 - dt
# RET xmm0 - time
# RET xmm1 - velocity
velocity_verlet:
  pxor   xmm7, xmm7                  # Holds 0 for comparisons
  pxor   xmm3, xmm3                  # Holds the velocity value
  pxor   xmm4, xmm4                  # Holds the time value
  comisd xmm0, xmm7                  # Check if pos is greater then 0.0
  jbe    velocity_verlet_return
  movsd  xmm5, half                  # xmm5 = 0.5 * dt * dt * acc
  mulsd  xmm5, xmm2
  mulsd  xmm5, xmm2
  mulsd  xmm5, xmm1
velocity_verlet_loop:
  movsd  xmm6, xmm3                  # Move velocity into register
  mulsd  xmm6, xmm2                  # Calculate new position
  addsd  xmm6, xmm5
  addsd  xmm0, xmm6
  addsd  xmm4, xmm2                  # Incrementing time
  movsd  xmm3, xmm4                  # Updating velocity
  mulsd  xmm3, xmm1
  comisd xmm0, xmm7
  ja     velocity_verlet_loop
velocity_verlet_return:
  movsd  xmm0, xmm4                  # Saving time and velocity
  movsd  xmm1, xmm3
  ret
</code></pre>
</div></div></div>

<p>Even though this method is more widely used than the simple Verlet method mentioned above, it unforunately has an error term of <script type="math/tex; ">\mathcal{O}(\Delta t^2)</script>, which is two orders of magnitude worse. That said, if you want to have a simulaton with many objects that depend on one another --- like a gravity simulation --- the Velocity Verlet algorithm is a handy choice; however, you may have to play further tricks to allow everything to scale appropriately. These types of simulatons are sometimes called <em>n-body</em> simulations and one such trick is the Barnes-Hut algorithm, which cuts the complexity of n-body simulations from <script type="math/tex; ">\sim \mathcal{O}(n^2)</script> to <script type="math/tex; ">\sim \mathcal{O}(n\log(n))</script>.</p>
<h2 id="example-code">Example Code</h2>
<p>Both of these methods work simply by iterating timestep-by-timestep and can be written straightforwardly in any language. For reference, here are snippets of code that use both the classic and velocity Verlet methods to find the time it takes for a ball to hit the ground after being dropped from a given height.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc * dt
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> time, vel
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> main()
    time = verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    println(<span class="hljs-string">&quot;Time for Verlet integration is: <span class="hljs-subst">$(time)</span>\n&quot;</span>)

    time, vel = stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    println(<span class="hljs-string">&quot;Time for Stormer Verlet integration is: <span class="hljs-subst">$(time)</span>&quot;</span>)
    println(<span class="hljs-string">&quot;Velocity for Stormer Verlet integration is: <span class="hljs-subst">$(vel)</span>\n&quot;</span>)

    time, vel = velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    println(<span class="hljs-string">&quot;Time for velocity Verlet integration is: <span class="hljs-subst">$(time)</span>&quot;</span>)
    println(<span class="hljs-string">&quot;Velocity for velocity Verlet integration is: <span class="hljs-subst">$(vel)</span>\n&quot;</span>)
<span class="hljs-keyword">end</span>

main()
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iomanip&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">struct</span> timestep {
  <span class="hljs-keyword">double</span> time;
  <span class="hljs-keyword">double</span> vel;
};

<span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> prev_pos = pos;
  <span class="hljs-keyword">double</span> time = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    <span class="hljs-keyword">double</span> next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = pos;
    pos = next_pos;
  }

  <span class="hljs-keyword">return</span> time;
}

<span class="hljs-function">timestep <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> prev_pos = pos;
  <span class="hljs-keyword">double</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">double</span> vel = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    <span class="hljs-keyword">double</span> next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = pos;
    pos = next_pos;

    <span class="hljs-comment">// The acceleration is constant, so the velocity is</span>
    <span class="hljs-comment">// straightforward</span>
    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> timestep { time, vel };
}

<span class="hljs-function">timestep <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">double</span> vel = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> timestep { time, vel };
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">std</span>::fixed &lt;&lt; <span class="hljs-built_in">std</span>::setprecision(<span class="hljs-number">8</span>);

  <span class="hljs-comment">// Note that depending on the simulation, you might want to have the</span>
  <span class="hljs-comment">// Verlet loop outside.</span>

  <span class="hljs-comment">// For example, if your acceleration chages as a function of time,</span>
  <span class="hljs-comment">// you might need to also change the acceleration to be read into</span>
  <span class="hljs-comment">// each of these functions.</span>

  <span class="hljs-keyword">double</span> time = verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Time for Verlet integration is: &quot;</span> \
            &lt;&lt; time &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;

  timestep timestep_sv = stormer_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Time for Stormer Verlet integration is: &quot;</span> \
            &lt;&lt; timestep_sv.time &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Velocity for Stormer Verlet integration is: &quot;</span> \
            &lt;&lt; timestep_sv.vel &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;

  timestep timestep_vv = velocity_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Time for velocity Verlet integration is: &quot;</span> \
            &lt;&lt; timestep_vv.time &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Velocity for velocity Verlet integration is: &quot;</span> \
            &lt;&lt; timestep_vv.vel &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

}
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> *time, <span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos;
    prev_pos = pos;
    *time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        *time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> *time, <span class="hljs-keyword">double</span> *vel,
                    <span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos;
    prev_pos = pos;
    *vel = <span class="hljs-number">0.0</span>;
    *time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        *time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        *vel += acc * dt;
    }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> *time, <span class="hljs-keyword">double</span> *vel,
                     <span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    *vel = <span class="hljs-number">0.0</span>;
    *time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        *time += dt;
        pos += (*vel) * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        *vel += acc * dt;
    }
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">double</span> time, vel;

    verlet(&amp;time, <span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Time for Verlet integration is: %lf\n&quot;</span>,
           time);

    stormer_verlet(&amp;time, &amp;vel, <span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Time and velocity for Stormer Verlet integration is: %lf, %lf\n&quot;</span>,
           time, vel);

    velocity_verlet(&amp;time, &amp;vel, <span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Time and velocity for velocity Verlet integration is: %lf, %lf\n&quot;</span>,
           time, vel);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-comment">// Submitted by lolatomroflsinnlos</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VerletValues</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> time;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> vel;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">VerletValues</span><span class="hljs-params">(<span class="hljs-keyword">double</span> time, <span class="hljs-keyword">double</span> vel)</span> </span>{
        <span class="hljs-keyword">this</span>.time = time;
        <span class="hljs-keyword">this</span>.vel = vel;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Verlet</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

      <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
      <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
      prev_pos = pos;
      time = <span class="hljs-number">0</span>;

      <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
            time += dt;
            temp_pos = pos;
            pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
            prev_pos = temp_pos;
        }

        <span class="hljs-keyword">return</span> time;
    }

    <span class="hljs-function"><span class="hljs-keyword">static</span> VerletValues <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

        <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
        <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
        prev_pos = pos;
        vel = <span class="hljs-number">0</span>;
        time = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
            time += dt;
            temp_pos = pos;
            pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
            prev_pos = temp_pos;

            <span class="hljs-comment">// The acceleration is constant, so the velocity is straightforward</span>
             vel += acc*dt;
        }

       VerletValues stormerVerlet = <span class="hljs-keyword">new</span> VerletValues(time, vel);
       <span class="hljs-keyword">return</span> stormerVerlet;
    }

    <span class="hljs-function"><span class="hljs-keyword">static</span> VerletValues <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

        <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
        <span class="hljs-keyword">double</span> time, vel;
        vel = <span class="hljs-number">0</span>;
        time = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
            time += dt;
            pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt;
            vel += acc*dt;
      }

        VerletValues velocityVerlet = <span class="hljs-keyword">new</span> VerletValues(time, vel);
        <span class="hljs-keyword">return</span> velocityVerlet;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{

        <span class="hljs-keyword">double</span> verletTime = verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0.01</span>);
        System.out.println(<span class="hljs-string">&quot;Time for Verlet integration is: &quot;</span> + verletTime);

        VerletValues stormerVerlet = stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0.01</span>);
        System.out.println(<span class="hljs-string">&quot;Time for Stormer Verlet integration is: &quot;</span> + stormerVerlet.time);
        System.out.println(<span class="hljs-string">&quot;Velocity for Stormer Verlet integration is: &quot;</span> + stormerVerlet.vel);

        VerletValues velocityVerlet = velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0.01</span>);
        System.out.println(<span class="hljs-string">&quot;Time for velocity Verlet integration is: &quot;</span> + velocityVerlet.time);
        System.out.println(<span class="hljs-string">&quot;Velocity for velocity Verlet integration is: &quot;</span> + velocityVerlet.vel);
    }
}
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verlet</span><span class="hljs-params">(pos, acc, dt)</span>:</span>
    prev_pos = pos
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span>:
        time += dt
        next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos, pos = pos, next_pos

    <span class="hljs-keyword">return</span> time

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(pos, acc, dt)</span>:</span>
    prev_pos = pos
    time = <span class="hljs-number">0</span>
    vel = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span>:
        time += dt
        next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos, pos = pos, next_pos
        vel += acc * dt

    <span class="hljs-keyword">return</span> time, vel

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(pos, acc, dt)</span>:</span>
    time = <span class="hljs-number">0</span>
    vel = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span>:
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt
        vel += acc * dt

    <span class="hljs-keyword">return</span> time, vel

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
    time = verlet(<span class="hljs-number">5</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>)
    print(<span class="hljs-string">&quot;Verlet&quot;</span>)
    print(<span class="hljs-string">&quot;Time: {:.10f}&quot;</span>.format(time))
    print()

    time, vel = stormer_verlet(<span class="hljs-number">5</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>)
    print(<span class="hljs-string">&quot;Stormer-Verlet&quot;</span>)
    print(<span class="hljs-string">&quot;Time: {:.10f}&quot;</span>.format(time))
    print(<span class="hljs-string">&quot;Velocity: {:.10f}&quot;</span>.format(vel))
    print()

    time, vel = velocity_verlet(<span class="hljs-number">5</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>)
    print(<span class="hljs-string">&quot;Velocity Verlet&quot;</span>)
    print(<span class="hljs-string">&quot;Time: {:.10f}&quot;</span>.format(time))
    print(<span class="hljs-string">&quot;Velocity: {:.10f}&quot;</span>.format(vel))
    print()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:
    main()
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre><code class="lang-haskell"><span class="hljs-comment">-- submitted by Jie</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Time</span> = <span class="hljs-type">Double</span></span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Position</span> = <span class="hljs-type">Double</span></span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Speed</span> = <span class="hljs-type">Double</span></span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Acceleration</span> = <span class="hljs-type">Double</span></span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Particle</span> = (<span class="hljs-type">Position</span>, <span class="hljs-type">Speed</span>, <span class="hljs-type">Acceleration</span>, <span class="hljs-type">Time</span>)</span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Model</span> = <span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Acceleration</span></span>

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Method</span> = <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Time</span> -&gt; <span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Particle</span></span>

<span class="hljs-title">verlet</span> :: <span class="hljs-type">Method</span>
<span class="hljs-title">verlet</span> acc dt (xOld, _, _, _) (x, _, a, t) = (x&apos;, v&apos;, a&apos;, t + dt)
  <span class="hljs-keyword">where</span>
    x&apos; = <span class="hljs-number">2</span> * x - xOld + a * dt ^ <span class="hljs-number">2</span>
    v&apos; = <span class="hljs-number">0</span>
    a&apos; = acc (x&apos;, v&apos;, a, t + dt)

<span class="hljs-title">stormerVerlet</span> :: <span class="hljs-type">Method</span>
<span class="hljs-title">stormerVerlet</span> acc dt (xOld, _, _, _) (x, _, a, t) = (x&apos;, v&apos;, a&apos;, t + dt)
  <span class="hljs-keyword">where</span>
    x&apos; = <span class="hljs-number">2</span> * x - xOld + a * dt ^ <span class="hljs-number">2</span>
    v&apos; = (x&apos; - x) / dt
    a&apos; = acc (x&apos;, v&apos;, a, t + dt)

<span class="hljs-title">velocityVerlet</span> :: <span class="hljs-type">Method</span>
<span class="hljs-title">velocityVerlet</span> acc dt (xOld, _, aOld, _) (x, v, a, t) = (x&apos;, v&apos;, a&apos;, t + dt)
  <span class="hljs-keyword">where</span>
    x&apos; = <span class="hljs-number">2</span> * x - xOld + a * dt ^ <span class="hljs-number">2</span>
    v&apos; = v + <span class="hljs-number">0.5</span> * (aOld + a) * dt
    a&apos; = acc (x&apos;, v&apos;, a, t + dt)

<span class="hljs-title">trajectory</span> :: <span class="hljs-type">Method</span> -&gt; <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Time</span> -&gt; <span class="hljs-type">Particle</span> -&gt; [<span class="hljs-type">Particle</span>]
<span class="hljs-title">trajectory</span> method acc dt p0@(x, v, a, t0) = traj
  <span class="hljs-keyword">where</span>
    traj = p0 : p1 : zipWith (method acc dt) traj (tail traj)
    p1 = (x&apos;, v&apos;, acc (x&apos;, v&apos;, a, t0 + dt), t0 + dt)
    x&apos; = x + v * dt + <span class="hljs-number">0.5</span> * a * dt ^ <span class="hljs-number">2</span>
    v&apos; = v + a * dt

<span class="hljs-title">main</span> :: <span class="hljs-type">IO</span> ()
<span class="hljs-title">main</span> = <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">let</span> p0 = (<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0</span>)
      dt = <span class="hljs-number">0.001</span>
      freefall _ = <span class="hljs-number">-10</span>
      aboveGround (x, _, _, _) = x &gt; <span class="hljs-number">0</span>
      integrate m = last $ takeWhile aboveGround $ trajectory m freefall dt p0
  print $ integrate verlet
  print $ integrate stormerVerlet
  print $ integrate velocityVerlet
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><p>Submitted by Jie</p>
<p></p><p>
    <img class="center" src="code/scratch/verlet_scratch.png">
</p>
Link: <a href="https://scratch.mit.edu/projects/173039394/" target="_blank">https://scratch.mit.edu/projects/173039394/</a><p></p>
</div><div class="code-method-sample" data-lang="matlab" data-name="Matlab"><pre><code class="lang-matlab"><span class="hljs-comment">% Submitted by P. Mekhail</span>
<span class="hljs-comment">% Parameters to change</span>
n = <span class="hljs-number">400</span>;        <span class="hljs-comment">% Number of steps</span>
x0 = <span class="hljs-number">5</span>;         <span class="hljs-comment">% Ball starting height(in metres)</span>
v0 = <span class="hljs-number">0</span>;         <span class="hljs-comment">% Ball starting velocity (+ive is up)</span>
dt = <span class="hljs-number">0.01</span>;      <span class="hljs-comment">% Time step (in seconds)</span>
eff = <span class="hljs-number">0.4</span>;      <span class="hljs-comment">% Ball efficency when bouncing</span>
A = @(x) <span class="hljs-number">-10</span>;   <span class="hljs-comment">% Acceleration as a function of position</span>
bounce = <span class="hljs-number">1</span>;     <span class="hljs-comment">% Do you want the ball to bounce?</span>

<span class="hljs-comment">% Making position and time vectors</span>
x = <span class="hljs-built_in">zeros</span>(n,<span class="hljs-number">1</span>);
t = <span class="hljs-number">0</span>:dt:n*dt-dt;

<span class="hljs-comment">% Setting the initial conditions</span>
x(<span class="hljs-number">1</span>) = x0;
x(<span class="hljs-number">2</span>) = x0 + v0*dt + <span class="hljs-number">0.5</span>*A(x0)*dt^<span class="hljs-number">2</span>;

<span class="hljs-comment">% Runnin Verlet Integration</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span> = <span class="hljs-number">2</span>:n<span class="hljs-number">-1</span>
    xnew = <span class="hljs-number">2</span>*x(<span class="hljs-built_in">i</span>)-x(<span class="hljs-built_in">i</span><span class="hljs-number">-1</span>)+A(x(<span class="hljs-built_in">i</span>))*dt^<span class="hljs-number">2</span>;
    <span class="hljs-keyword">if</span> bounce
        <span class="hljs-keyword">if</span> xnew &gt; <span class="hljs-number">0</span>
            <span class="hljs-comment">% If you haven&apos;t hit the ground keep going</span>
            x(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = xnew;
        <span class="hljs-keyword">else</span>
            <span class="hljs-comment">% If you have calculated velocity and invert its sign</span>
            v = <span class="hljs-built_in">sqrt</span>(eff)*(xnew-x(<span class="hljs-built_in">i</span><span class="hljs-number">-1</span>))/(<span class="hljs-number">2</span>*dt);
            x(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = x(<span class="hljs-built_in">i</span>) - v*dt + <span class="hljs-number">0.5</span>*A(x(<span class="hljs-built_in">i</span>))*dt^<span class="hljs-number">2</span>;
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">else</span>
        x(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = xnew;
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
plot(t,x)
title(<span class="hljs-string">&apos;Ball&apos;&apos;s Trajectory&apos;</span>)
xlabel(<span class="hljs-string">&apos;Time (s)&apos;</span>); ylabel(<span class="hljs-string">&apos;Height (m)&apos;</span>);
</code></pre>
</div><div class="code-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Submitted by P. Mekhail</p>
<p>
    <img class="center" src="code/labview/verlet_labview.png">
</p></div><div class="code-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verlet</span>(<span class="hljs-params">pos, acc, dt</span>) </span>{
  <span class="hljs-keyword">let</span> prevPos = pos;
  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> tempPos;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    tempPos = pos;
    pos = pos * <span class="hljs-number">2</span> - prevPos + acc * dt * dt;
    prevPos = tempPos;
  }

  <span class="hljs-keyword">return</span> time;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stormerVerlet</span>(<span class="hljs-params">pos, acc, dt</span>) </span>{
  <span class="hljs-keyword">let</span> prevPos = pos;
  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> vel = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> tempPos;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    tempPos = pos;
    pos = pos * <span class="hljs-number">2</span> - prevPos + acc * dt * dt;
    prevPos = tempPos;

    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> { time, vel };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">velocityVerlet</span>(<span class="hljs-params">pos, acc, dt</span>) </span>{
  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> vel = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
    vel += acc * dt;
  }

  <span class="hljs-keyword">return</span> { time, vel };
}

<span class="hljs-keyword">const</span> time = verlet(<span class="hljs-number">5</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Time for Verlet integration is: <span class="hljs-subst">${time}</span>\n`</span>);

<span class="hljs-keyword">const</span> stormer = stormerVerlet(<span class="hljs-number">5</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Time for Stormer Verlet integration is: <span class="hljs-subst">${stormer.time}</span>`</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Velocity for Stormer Verlet integration is: <span class="hljs-subst">${stormer.vel}</span>\n`</span>);

<span class="hljs-keyword">const</span> velocity = velocityVerlet(<span class="hljs-number">5</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Time for Velocity Verlet integration is: <span class="hljs-subst">${velocity.time}</span>`</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Velocity for Velocity Verlet integration is: <span class="hljs-subst">${velocity.vel}</span>\n`</span>);
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) -&gt; <span class="hljs-keyword">f64</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    time
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">stormer_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) -&gt; (<span class="hljs-keyword">f64</span>, <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vel = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        <span class="hljs-comment">// Because acceleration is constant, velocity is</span>
        <span class="hljs-comment">// straightforward</span>
        vel += acc * dt;
    }

    (time, vel)
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">velocity_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) -&gt; (<span class="hljs-keyword">f64</span>, <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vel = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    }

    (time, vel)
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    <span class="hljs-keyword">let</span> time_v = verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    <span class="hljs-keyword">let</span> (time_sv, vel_sv) = stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    <span class="hljs-keyword">let</span> (time_vv, vel_vv) = velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Time for original Verlet integration: {}&quot;</span>, time_v);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Time and velocity for Stormer Verlet integration: {}, {}&quot;</span>, time_sv, vel_sv);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Time and velocity for velocity Verlet integration: {}, {}&quot;</span>, time_vv, vel_vv);
}
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">verlet</span><span class="hljs-params">(pos: Double, acc: Double, dt: Double)</span></span> -&gt; <span class="hljs-type">Double</span> {
    <span class="hljs-keyword">var</span> pos = pos
    <span class="hljs-keyword">var</span> temp_pos, time: <span class="hljs-type">Double</span>
    <span class="hljs-keyword">var</span> prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    }

    <span class="hljs-keyword">return</span> time
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stormerVerlet</span><span class="hljs-params">(pos: Double, acc: Double, dt: Double)</span></span> -&gt; (time: <span class="hljs-type">Double</span>, vel: <span class="hljs-type">Double</span>) {
    <span class="hljs-keyword">var</span> pos = pos
    <span class="hljs-keyword">var</span> temp_pos, time, vel: <span class="hljs-type">Double</span>
    <span class="hljs-keyword">var</span> prev_pos = pos
    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        vel += acc*dt
    }

    <span class="hljs-keyword">return</span> (time:time, vel:vel)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">velocityVerlet</span><span class="hljs-params">(pos: Double, acc: Double, dt: Double)</span></span> -&gt; (time: <span class="hljs-type">Double</span>, vel: <span class="hljs-type">Double</span>) {
    <span class="hljs-keyword">var</span> pos = pos
    <span class="hljs-keyword">var</span> time, vel : <span class="hljs-type">Double</span>
    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt
        vel += acc*dt
    }

    <span class="hljs-keyword">return</span> (time:time, vel:vel)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">let</span> verletTime = verlet(pos: <span class="hljs-number">5.0</span>, acc: -<span class="hljs-number">10.0</span>, dt: <span class="hljs-number">0.01</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Time for Verlet integration is: <span class="hljs-subst">\(verletTime)</span>&quot;</span>)

    <span class="hljs-keyword">let</span> stormer = stormerVerlet(pos: <span class="hljs-number">5.0</span>, acc: -<span class="hljs-number">10.0</span>, dt: <span class="hljs-number">0.01</span>);
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Time for Stormer Verlet integration is: <span class="hljs-subst">\(stormer.time)</span>&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Velocity for Stormer Verlet integration is: <span class="hljs-subst">\(stormer.vel)</span>&quot;</span>)

    <span class="hljs-keyword">let</span> velVerlet = velocityVerlet(pos: <span class="hljs-number">5.0</span>, acc: -<span class="hljs-number">10</span>, dt: <span class="hljs-number">0.01</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Time for velocity Verlet integration is: <span class="hljs-subst">\(velVerlet.time)</span>&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Velocity for velocity Verlet integration is: <span class="hljs-subst">\(velVerlet.vel)</span>&quot;</span>)
}

main()
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre><code class="lang-fortran"><span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> verlet(pos, acc, dt, time) 
    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span>
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos


    prev_pos = pos
    time     = <span class="hljs-number">0d0</span>

    <span class="hljs-keyword">DO</span>
        <span class="hljs-keyword">IF</span> (pos &gt; <span class="hljs-number">0d0</span>) <span class="hljs-keyword">THEN</span>
            time     = time + dt
            next_pos = pos * <span class="hljs-number">2d0</span> - prev_pos + acc * dt ** <span class="hljs-number">2</span>
            prev_pos = pos
            pos      = next_pos
        <span class="hljs-keyword">ELSE</span>
            <span class="hljs-keyword">EXIT</span>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">DO</span>
<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> verlet

<span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> stormer_verlet(pos, acc, dt, time, vel) 
    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span>
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time, vel
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos

    prev_pos = pos 
    time     = <span class="hljs-number">0d0</span>
    vel      = <span class="hljs-number">0d0</span>

    <span class="hljs-keyword">DO</span>
        <span class="hljs-keyword">IF</span> (pos &gt; <span class="hljs-number">0d0</span>) <span class="hljs-keyword">THEN</span>
            time     = time + dt
            next_pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt ** <span class="hljs-number">2</span>
            prev_pos = pos
            pos      = next_pos
            vel      = vel + acc * dt
        <span class="hljs-keyword">ELSE</span>
            <span class="hljs-keyword">EXIT</span>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">DO</span>
<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> stormer_verlet 

<span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> velocity_verlet(pos, acc, dt, time, vel) 
    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span>
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time, vel

    time     = <span class="hljs-number">0d0</span>
    vel      = <span class="hljs-number">0d0</span>

    <span class="hljs-keyword">DO</span>
        <span class="hljs-keyword">IF</span> (pos &gt; <span class="hljs-number">0d0</span>) <span class="hljs-keyword">THEN</span>
            time = time + dt
            pos  = pos + vel * dt + <span class="hljs-number">0.5d0</span> * acc * dt ** <span class="hljs-number">2</span> 
            vel  = vel + acc * dt
        <span class="hljs-keyword">ELSE</span>
            <span class="hljs-keyword">EXIT</span>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">DO</span>
<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> velocity_verlet 

<span class="hljs-function"><span class="hljs-keyword">PROGRAM</span></span> verlet_integration

    <span class="hljs-keyword">IMPLICIT</span> <span class="hljs-keyword">NONE</span> 
    <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>) :: pos,acc, dt, time, vel

    <span class="hljs-keyword">INTERFACE</span>
        <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> verlet(pos, acc, dt, time)
        <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time
        <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos
        <span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">INTERFACE</span> 

    <span class="hljs-keyword">INTERFACE</span> 
        <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> stormer_verlet(pos, acc, dt, time, vel) 
            <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time, vel
            <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos
        <span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> 
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">INTERFACE</span> 

    <span class="hljs-keyword">INTERFACE</span> 
        <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> velocity_verlet(pos, acc, dt, time, vel) 
            <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>), <span class="hljs-keyword">INTENT</span>(INOUT) :: pos, acc, dt, time, vel
            <span class="hljs-keyword">REAL</span>(<span class="hljs-number">8</span>)                :: prev_pos, next_pos 
        <span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">SUBROUTINE</span></span> 
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">INTERFACE</span> 

    pos = <span class="hljs-number">5d0</span>
    acc = -<span class="hljs-number">10d0</span>
    dt  = <span class="hljs-number">0.01d0</span>
    <span class="hljs-comment">! Verlet </span>
    <span class="hljs-keyword">CALL</span> verlet(pos, acc, dt, time)

    <span class="hljs-built_in">WRITE</span>(*,*) <span class="hljs-string">&apos;Time for Verlet integration: &apos;</span>, time 

    <span class="hljs-comment">! stormer Verlet </span>
    pos = <span class="hljs-number">5d0</span>
    <span class="hljs-keyword">CALL</span> stormer_verlet(pos, acc, dt, time, vel)

    <span class="hljs-built_in">WRITE</span>(*,*) <span class="hljs-string">&apos;Time for Stormer-Verlet integration: &apos;</span>, time 

    <span class="hljs-comment">! Velocity Verlet</span>
    pos = <span class="hljs-number">5d0</span>
    <span class="hljs-keyword">CALL</span> velocity_verlet(pos, acc, dt, time, vel)

    <span class="hljs-built_in">WRITE</span>(*,*) <span class="hljs-string">&apos;Time for Velocity-Verlet integration: &apos;</span>, time 

<span class="hljs-keyword">END</span> <span class="hljs-function"><span class="hljs-keyword">PROGRAM</span></span> verlet_integration
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre><code class="lang-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verlet</span><span class="hljs-params">(pos, acc, dt)</span></span>

    prev_pos = pos
    time = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

   <span class="hljs-keyword">return</span> time

<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(pos, acc, dt)</span></span>

    prev_pos = pos
    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>
        time += dt
        temp_pos = pos
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        vel += acc*dt
    <span class="hljs-keyword">end</span>

   <span class="hljs-keyword">return</span> time

<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(pos, acc, dt)</span></span>

    vel = <span class="hljs-number">0</span>
    time = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>
        time += dt
        pos += vel*dt + <span class="hljs-number">0</span>.<span class="hljs-number">5</span>*acc * dt * dt
        vel += acc*dt
    <span class="hljs-keyword">end</span>

   <span class="hljs-keyword">return</span> time

<span class="hljs-keyword">end</span>

p verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0</span>.<span class="hljs-number">01</span>)
p stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0</span>.<span class="hljs-number">01</span>)
p velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0</span>.<span class="hljs-number">01</span>)
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span>

<span class="hljs-keyword">func</span> verlet(pos, acc, dt <span class="hljs-keyword">float64</span>) (time <span class="hljs-keyword">float64</span>) {
    prevPos := pos
    time = <span class="hljs-number">0</span>

    <span class="hljs-keyword">for</span> pos &gt; <span class="hljs-number">0</span> {
        time += dt
        nextPos := pos*<span class="hljs-number">2</span> - prevPos + acc*dt*dt
        prevPos, pos = pos, nextPos
    }

    <span class="hljs-keyword">return</span>
}

<span class="hljs-keyword">func</span> stormerVerlet(pos, acc, dt <span class="hljs-keyword">float64</span>) (time, vel <span class="hljs-keyword">float64</span>) {
    prevPos := pos
    time, vel = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>

    <span class="hljs-keyword">for</span> pos &gt; <span class="hljs-number">0</span> {
        time += dt
        vel += acc * dt
        nextPos := pos*<span class="hljs-number">2</span> - prevPos + acc*dt*dt
        prevPos, pos = pos, nextPos
    }

    <span class="hljs-keyword">return</span>
}

<span class="hljs-keyword">func</span> velocityVerlet(pos, acc, dt <span class="hljs-keyword">float64</span>) (time, vel <span class="hljs-keyword">float64</span>) {
    time, vel = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>

    <span class="hljs-keyword">for</span> pos &gt; <span class="hljs-number">0</span> {
        time += dt
        pos += vel*dt + <span class="hljs-number">.5</span>*acc*dt*dt
        vel += acc * dt
    }

    <span class="hljs-keyword">return</span>
}

<span class="hljs-keyword">func</span> main() {
    time := verlet(<span class="hljs-number">5.</span>, <span class="hljs-number">-10.</span>, <span class="hljs-number">.01</span>)
    fmt.Println(<span class="hljs-string">&quot;Verlet&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;Time:&quot;</span>, time)
    fmt.Println()

    time, vel := stormerVerlet(<span class="hljs-number">5.</span>, <span class="hljs-number">-10.</span>, <span class="hljs-number">.01</span>)
    fmt.Println(<span class="hljs-string">&quot;Stormer-Verlet&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;Time:&quot;</span>, time)
    fmt.Println(<span class="hljs-string">&quot;Velocity:&quot;</span>, vel)
    fmt.Println()

    time, vel = velocityVerlet(<span class="hljs-number">5.</span>, <span class="hljs-number">-10.</span>, <span class="hljs-number">.01</span>)
    fmt.Println(<span class="hljs-string">&quot;Velocity Verlet&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;Time:&quot;</span>, time)
    fmt.Println(<span class="hljs-string">&quot;Velocity:&quot;</span>, vel)
}
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre><code class="lang-asm-x64">.intel_syntax noprefix

.section .rodata
  zero:          .double 0.0
  two:           .double 2.0
  half:          .double 0.5
  verlet_fmt:    .string &quot;Time for Verlet integration is: %lf\n&quot;
  stormer_fmt:   .string &quot;Time and Velocity for Stormer Verlet Integration is: %lf, %lf\n&quot;
  velocity_fmt:  .string &quot;Time and Velocity for Velocity Verlet Integration is: %lf, %lf\n&quot;
  pos:           .double 5.0
  acc:           .double -10.0
  dt:            .double 0.01

.section .text
  .global main
  .extern printf

# xmm0 - pos
# xmm1 - acc
# xmm2 - dt
# RET xmm0 - time
verlet:
  pxor   xmm7, xmm7                  # Holds 0 for comparisons
  pxor   xmm3, xmm3                  # Holds time value
  comisd xmm0, xmm7                  # Check if pos is greater then 0.0
  jbe    verlet_return
  movsd  xmm6, xmm1                  # xmm6 = acc * dt * dt
  mulsd  xmm6, xmm2
  mulsd  xmm6, xmm2
  movsd  xmm5, xmm0                  # Holds previous position
verlet_loop:
  addsd  xmm3, xmm2                  # Adding dt to time
  movsd  xmm4, xmm0                  # Hold old value of posistion
  addsd  xmm0, xmm0                  # Calculating new position
  subsd  xmm0, xmm5
  addsd  xmm0, xmm6
  movsd  xmm5, xmm4
  comisd xmm0, xmm7                  # Check if position is greater then 0.0
  ja     verlet_loop
verlet_return:
  movsd  xmm0, xmm3                  # Saving time value
  ret

# xmm0 - pos
# xmm1 - acc
# xmm2 - dt
# RET xmm0 - time
# RET xmm1 - velocity
stormer_verlet:
  pxor   xmm7, xmm7                  # Holds 0 for comparisons
  pxor   xmm3, xmm3                  # Holds time value
  comisd xmm0, xmm7                  # Check if pos is greater then 0.0
  jbe    stormer_verlet_return
  movsd  xmm6, xmm1                  # xmm6 = acc * dt * dt
  mulsd  xmm6, xmm2
  mulsd  xmm6, xmm2
  movsd  xmm5, xmm0                  # Holds previous position
stormer_verlet_loop:
  addsd  xmm3, xmm2                  # Adding dt to time
  movsd  xmm4, xmm0                  # Hold old value of posistion
  addsd  xmm0, xmm0                  # Calculating new position
  subsd  xmm0, xmm5
  addsd  xmm0, xmm6
  movsd  xmm5, xmm4
  comisd xmm0, xmm7                  # Check if position is greater then 0.0
  ja     stormer_verlet_loop
stormer_verlet_return:
  movsd  xmm0, xmm3                  # Saving time and velocity
  mulsd  xmm3, xmm1
  movsd  xmm1, xmm3
  ret

# xmm0 - pos
# xmm1 - acc
# xmm2 - dt
# RET xmm0 - time
# RET xmm1 - velocity
velocity_verlet:
  pxor   xmm7, xmm7                  # Holds 0 for comparisons
  pxor   xmm3, xmm3                  # Holds the velocity value
  pxor   xmm4, xmm4                  # Holds the time value
  comisd xmm0, xmm7                  # Check if pos is greater then 0.0
  jbe    velocity_verlet_return
  movsd  xmm5, half                  # xmm5 = 0.5 * dt * dt * acc
  mulsd  xmm5, xmm2
  mulsd  xmm5, xmm2
  mulsd  xmm5, xmm1
velocity_verlet_loop:
  movsd  xmm6, xmm3                  # Move velocity into register
  mulsd  xmm6, xmm2                  # Calculate new position
  addsd  xmm6, xmm5
  addsd  xmm0, xmm6
  addsd  xmm4, xmm2                  # Incrementing time
  movsd  xmm3, xmm4                  # Updating velocity
  mulsd  xmm3, xmm1
  comisd xmm0, xmm7
  ja     velocity_verlet_loop
velocity_verlet_return:
  movsd  xmm0, xmm4                  # Saving time and velocity
  movsd  xmm1, xmm3
  ret

main:
  push   rbp
  movsd  xmm0, pos                   # Calling verlet
  movsd  xmm1, acc
  movsd  xmm2, dt
  call   verlet
  mov    rdi, OFFSET verlet_fmt      # Print output
  mov    rax, 1
  call   printf
  movsd  xmm0, pos                   # Calling stormer_verlet
  movsd  xmm1, acc
  movsd  xmm2, dt
  call   stormer_verlet
  mov    rdi, OFFSET stormer_fmt     # Print output
  mov    rax, 1
  call   printf
  movsd  xmm0, pos                   # Calling velocity_verlet
  movsd  xmm1, acc
  movsd  xmm2, dt
  call   velocity_verlet
  mov    rdi, OFFSET velocity_fmt    # Print output
  mov    rax, 1
  call   printf
  pop    rbp
  ret
</code></pre>
</div></div></div>


<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../physics_solvers/physics_solvers.html" class="navigation navigation-prev " aria-label="Previous page: Physics Solvers">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../quantum_systems/quantum_systems.html" class="navigation navigation-next " aria-label="Next page: Quantum Systems">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Verlet Integration","level":"1.15.1","depth":2,"next":{"title":"Quantum Systems","level":"1.15.2","depth":2,"path":"contents/quantum_systems/quantum_systems.md","ref":"contents/quantum_systems/quantum_systems.md","articles":[{"title":"Split-Operator Method","level":"1.15.2.1","depth":3,"path":"contents/split-operator_method/split-operator_method.md","ref":"contents/split-operator_method/split-operator_method.md","articles":[]}]},"previous":{"title":"Physics Solvers","level":"1.15","depth":1,"path":"contents/physics_solvers/physics_solvers.md","ref":"contents/physics_solvers/physics_solvers.md","articles":[{"title":"Verlet Integration","level":"1.15.1","depth":2,"path":"contents/verlet_integration/verlet_integration.md","ref":"contents/verlet_integration/verlet_integration.md","articles":[]},{"title":"Quantum Systems","level":"1.15.2","depth":2,"path":"contents/quantum_systems/quantum_systems.md","ref":"contents/quantum_systems/quantum_systems.md","articles":[{"title":"Split-Operator Method","level":"1.15.2.1","depth":3,"path":"contents/split-operator_method/split-operator_method.md","ref":"contents/split-operator_method/split-operator_method.md","articles":[]}]}]},"dir":"ltr"},"config":{"plugins":["fontsettings","mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","creativecommons","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","ga","bulk-redirect"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"}]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"highlight":{},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"creativecommons":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"ga":{"configuration":"auto","token":"UA-118252470-1"},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}}],"gitbook":"3.x.x"},"file":{"path":"contents/verlet_integration/verlet_integration.md","mtime":"2018-10-23T00:16:16.715Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-10-23T00:17:56.382Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    

    </body>
</html>

