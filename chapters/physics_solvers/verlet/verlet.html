
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Verlet Integration Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../barnes_hut.html" />
    
    
    <link rel="prev" href="../physics_solvers.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../TODO.html">
            
                <a href="../../../TODO.html">
            
                    
                    TODO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../introduction.html">
            
                <a href="../../introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../getting_started.html">
            
                <a href="../../getting_started.html">
            
                    
                    A Personal Note
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../how_to_contribute.html">
            
                <a href="../../how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../principles_of_code/principles_of_code.html">
            
                <a href="../../principles_of_code/principles_of_code.html">
            
                    
                    Principles of Code
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../principles_of_code/choosing_a_language/choosing_a_language.html">
            
                <a href="../../principles_of_code/choosing_a_language/choosing_a_language.html">
            
                    
                    Choosing A Language
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../../principles_of_code/choosing_a_language/compiled/compiled.html">
            
                <a href="../../principles_of_code/choosing_a_language/compiled/compiled.html">
            
                    
                    Compiled Languages
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1.1" data-path="../../principles_of_code/choosing_a_language/compiled/makefiles.html">
            
                <a href="../../principles_of_code/choosing_a_language/compiled/makefiles.html">
            
                    
                    Makefiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.1.2" data-path="../../principles_of_code/choosing_a_language/compiled/FORTRAN.html">
            
                <a href="../../principles_of_code/choosing_a_language/compiled/FORTRAN.html">
            
                    
                    FORTRAN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../principles_of_code/building_blocks/building_blocks.html">
            
                <a href="../../principles_of_code/building_blocks/building_blocks.html">
            
                    
                    Building Blocks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../../principles_of_code/building_blocks/variables.html">
            
                <a href="../../principles_of_code/building_blocks/variables.html">
            
                    
                    Variables and Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="../../principles_of_code/building_blocks/conditions.html">
            
                <a href="../../principles_of_code/building_blocks/conditions.html">
            
                    
                    Conditions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="../../principles_of_code/building_blocks/loops.html">
            
                <a href="../../principles_of_code/building_blocks/loops.html">
            
                    
                    Loops
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="../../principles_of_code/building_blocks/functions.html">
            
                <a href="../../principles_of_code/building_blocks/functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="../../principles_of_code/building_blocks/classes.html">
            
                <a href="../../principles_of_code/building_blocks/classes.html">
            
                    
                    Classes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="../../principles_of_code/building_blocks/stacks.html">
            
                <a href="../../principles_of_code/building_blocks/stacks.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.7" data-path="../../principles_of_code/building_blocks/bitlogic.html">
            
                <a href="../../principles_of_code/building_blocks/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../principles_of_code/version_control.html">
            
                <a href="../../principles_of_code/version_control.html">
            
                    
                    Version Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../../principles_of_code/notation/notation.html">
            
                <a href="../../principles_of_code/notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../convolutions/convolutions.html">
            
                <a href="../../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../taylor/taylor_series.html">
            
                <a href="../../taylor/taylor_series.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../sorting_searching/sorting_searching.html">
            
                <a href="../../sorting_searching/sorting_searching.html">
            
                    
                    Sorting and Searching
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../sorting_searching/bubble/bubble_sort.html">
            
                <a href="../../sorting_searching/bubble/bubble_sort.html">
            
                    
                    Bubble Sort
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../../sorting_searching/bogo/bogo_sort.html">
            
                <a href="../../sorting_searching/bogo/bogo_sort.html">
            
                    
                    Bogo Sort
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../tree_traversal/tree_traversal.html">
            
                <a href="../../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../../euclidean_algorithm/euclidean.html">
            
                <a href="../../euclidean_algorithm/euclidean.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../../multiplication/multiplication.html">
            
                <a href="../../multiplication/multiplication.html">
            
                    
                    Multiplication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../../monte_carlo/monte_carlo.html">
            
                <a href="../../monte_carlo/monte_carlo.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../../matrix_methods/matrix_methods.html">
            
                <a href="../../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../../matrix_methods/gaussian_elimination/gaussian_elimination.html">
            
                <a href="../../matrix_methods/gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../../matrix_methods/thomas/thomas.html">
            
                <a href="../../matrix_methods/thomas/thomas.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../../computational_geometry/computational_geometry.html">
            
                <a href="../../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../../computational_geometry/gift_wrapping/gift_wrapping.html">
            
                <a href="../../computational_geometry/gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1.1" data-path="../../computational_geometry/gift_wrapping/jarvis_march/jarvis_march.html">
            
                <a href="../../computational_geometry/gift_wrapping/jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.1.2" data-path="../../computational_geometry/gift_wrapping/graham_scan/graham_scan.html">
            
                <a href="../../computational_geometry/gift_wrapping/graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.1.3" data-path="../../computational_geometry/gift_wrapping/chan/chans.html">
            
                <a href="../../computational_geometry/gift_wrapping/chan/chans.html">
            
                    
                    Chan's Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../../FFT/cooley_tukey.html">
            
                <a href="../../FFT/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../../decision_problems/decision_problems.html">
            
                <a href="../../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../../decision_problems/stable_marriage/stable_marriage.html">
            
                <a href="../../decision_problems/stable_marriage/stable_marriage.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../../differential_equations/differential_equations.html">
            
                <a href="../../differential_equations/differential_equations.html">
            
                    
                    Differential Equation Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../../differential_equations/euler/euler.html">
            
                <a href="../../differential_equations/euler/euler.html">
            
                    
                    Forward Euler Method
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../../differential_equations/euler/backward_euler.html">
            
                <a href="../../differential_equations/euler/backward_euler.html">
            
                    
                    Backward Euler Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.3" data-path="../../differential_equations/runge_kutta/runge_kutta.html">
            
                <a href="../../differential_equations/runge_kutta/runge_kutta.html">
            
                    
                    Runge Kutta
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../physics_solvers.html">
            
                <a href="../physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.19.1" data-path="verlet.html">
            
                <a href="verlet.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.2" data-path="../barnes_hut.html">
            
                <a href="../barnes_hut.html">
            
                    
                    Barnes-Hut
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.3" data-path="../quantum/quantum.html">
            
                <a href="../quantum/quantum.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.3.1" data-path="../quantum/split-op/split-op.html">
            
                <a href="../quantum/split-op/split-op.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../../data_compression/data_compression.html">
            
                <a href="../../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="../../data_compression/huffman/huffman.html">
            
                <a href="../../data_compression/huffman/huffman.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="../../QI/QI.html">
            
                <a href="../../QI/QI.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Verlet Integration</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="verlet-integration">Verlet Integration</h1>
<p>Verlet Integration is essentially a solution to the kinematic equation for the motion of any object,</p>
<p><script type="math/tex; mode=display">
x = x_0 + v_0t + \frac{1}{2}at^2 + \frac{1}{6}bt^3 + \cdots
</script></p>
<p>Where <script type="math/tex; ">x</script> is the position, <script type="math/tex; ">v</script> is the velocity, <script type="math/tex; ">a</script> is the acceleration, <script type="math/tex; ">b</script> is the often forgotten jerk term, and <script type="math/tex; ">t</script> is time. This equation is a central equation to almost every Newtonian physics solver and brings up a class of algorithms known as <em>force integrators</em>. One of the first force integrators to work with is <em>Verlet Integration</em>.</p>
<p>So, let&apos;s say we want to solve for the next timestep in <script type="math/tex; ">x</script>. To a close approximation (actually performing a Taylor Series Expansion about <script type="math/tex; ">x(t\pm \Delta t)</script>), that might look like this:</p>
<p><script type="math/tex; mode=display">
x(t+\Delta t) = x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 + \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>This means that if we need to find the next <script type="math/tex; ">x</script>, we need the current <script type="math/tex; ">x</script>, <script type="math/tex; ">v</script>, <script type="math/tex; ">a</script>, etc. However, because few people calculate the jerk term, our error is typically <script type="math/tex; ">\mathcal{O}(\Delta t^3)</script>. That said, we can calculate <script type="math/tex; ">x</script> with less knowledge and higher accuracy if we play a trick! Let&apos;s say we want to calculate <script type="math/tex; ">x</script> of the <em>previous</em> timestep. Again, to a close approximation, that might look like this:</p>
<p><script type="math/tex; mode=display">
x(t-\Delta t) = x(t) - v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 - \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>Now, we have two equations to solve for two different timesteps in x, one of which we already have. If we add the two equations together and solve for <script type="math/tex; ">x(t+\Delta t)</script>, we find</p>
<p><script type="math/tex; mode=display">
x(t+ \Delta t) = 2x(t) - x(t-\Delta t) + a(t)\Delta t^2 + \mathcal{O}(\Delta t^4)
</script></p>
<p>So, this means, we can find our next <script type="math/tex; ">x</script> simply by knowing our current <script type="math/tex; ">x</script>, the <script type="math/tex; ">x</script> before that, and the acceleration! No velocity necessary! In addition, this drops the error to <script type="math/tex; ">\mathcal{O}(\Delta t^4)</script>, which is great!
Here is what it looks like in code:</p>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
  <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
  prev_pos = pos;
  time = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    temp_pos = pos;
    pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = temp_pos;
  }

  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;
}
</code></pre>
</div><div class="api-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
    prev_pos = pos;
    time = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, time);
}
</code></pre>
</div><div class="api-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span></span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
    prev_pos = pos;
    time = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    System.out.println(time);

}
</code></pre>
</div><div class="api-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Verlet</span><span class="hljs-params">(Simulation)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        temp_pos = self.obj.pos
        self.obj.pos = self.obj.pos * <span class="hljs-number">2</span> - self.prev_pos + self.obj.acc * self.dt * self.dt
        self.prev_pos = temp_pos
</code></pre>
</div><div class="api-method-sample" data-lang="hs" data-name="Haskell"><p>Unfortunately, this has not yet been implemented in haskell, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verlet</span>(<span class="hljs-params">pos, acc, dt</span>)</span>{

    <span class="hljs-keyword">var</span> prev_pos, temp_pos, time;
    prev_pos = pos;
    time = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

   <span class="hljs-keyword">return</span> time;

}
</code></pre>
</div><div class="api-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, time);
}
</code></pre>
</div></div></div>



<p>Now, obviously this poses a problem, what if we want to calculate a term that requires velocity, like the kinetic energy, <script type="math/tex; ">\frac{1}{2}mv^2</script>? In this case, we certainly cannot get rid of the velocity! Well, we can find the velocity to <script type="math/tex; ">\mathcal{O}(\Delta t^2)</script> accuracy by using the Stormer-Verlet method, which is the same as before, but we calculate velocity like so</p>
<p><script type="math/tex; mode=display">
v(t) = \frac{x(t+\Delta t) - x(t-\Delta t)}{2\Delta t} + \mathcal{O}(\Delta t^2)
</script></p>
<p>Note that the 2 in the denominator appears because we are going over 2 timesteps. It&apos;s essentially solving <script type="math/tex; ">v=\frac{\Delta x}{\Delta t}</script>. In addition, we can calculate the velocity of the next timestep like so</p>
<p><script type="math/tex; mode=display">
v(t+\Delta t) = \frac{x(t+\Delta t) - x(t)}{\Delta t} + \mathcal{O}(\Delta t)
</script></p>
<p>However, the error for this is <script type="math/tex; ">\mathcal{O}(\Delta t)</script>, which is quite poor, but get&apos;s the job done in a pinch.
Here&apos;s what it looks like in code:</p>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc*dt
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
  <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
  prev_pos = pos;
  vel = <span class="hljs-number">0</span>;
  time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    temp_pos = pos;
    pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = temp_pos;

    <span class="hljs-comment">// The acceleration is constant, so the velocity is straightforward</span>
    vel += acc * dt;
  }

  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;
}
</code></pre>
</div><div class="api-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        vel += acc * dt;
    }

   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, time);
}
</code></pre>
</div><div class="api-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span></span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

       <span class="hljs-comment">// The acceleration is constant, so the velocity is straightforward</span>
       vel += acc*dt;
    }

    System.out.println(time);

}
</code></pre>
</div><div class="api-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Stormer_Verlet</span><span class="hljs-params">(Simulation)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        temp_pos = self.obj.pos
        self.obj.pos = self.obj.pos * <span class="hljs-number">2</span> - self.prev_pos + self.obj.acc * self.dt * self.dt
        self.prev_pos = temp_pos

        self.obj.vel += self.obj.acc * self.dt
</code></pre>
</div><div class="api-method-sample" data-lang="hs" data-name="Haskell"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc*dt
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc*dt
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc*dt
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc*dt
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stormer_verlet</span>(<span class="hljs-params">pos, acc, dt</span>)</span>{

    <span class="hljs-keyword">var</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        vel += acc*dt;
    }

   <span class="hljs-keyword">return</span> time;

}
</code></pre>
</div><div class="api-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">stormer_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, time);
}
</code></pre>
</div></div></div>


<p>Now, let&apos;s say we actually need the velocity to calculate out next timestep. Well, in this case, we simply cannot use the above approximation and instead need to use the <em>Velocity Verlet</em> algorithm.</p>
<h1 id="velocity-verlet">Velocity Verlet</h1>
<p>In some ways, this algorithm is even simpler than above. We can calculate everything like so</p>
<p><script type="math/tex; mode=display">
\begin{align}
x(t+\Delta t) &=x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t) + \frac{1}{2}(a(t) + a(t+\Delta t))\Delta t
\end{align}
</script></p>
<p>Which is literally the kinematic equation above, solving for <script type="math/tex; ">x</script>, <script type="math/tex; ">v</script>, and <script type="math/tex; ">a</script> every timestep. You can also split up the equations like so</p>
<p><script type="math/tex; mode=display">
\begin{align}
v(t+\frac{1}{2}\Delta t) &= v(t) + \frac{1}{2}a(t)\Delta t \\
x(t+\Delta t) &=x(t) + v(t+\frac{1}{2}\Delta t)\Delta t \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t+\frac{1}{2}\Delta t) + \frac{1}{2}a(t+\Delta t)\Delta t
\end{align}
</script></p>
<p>Here is the velocity Verlet method in code:</p>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> time, vel;
  vel = <span class="hljs-number">0</span>;
  time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
    vel += acc * dt;
  }

  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;
}
</code></pre>
</div><div class="api-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    }

   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, time);
}
</code></pre>
</div><div class="api-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span></span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt;
        vel += acc*dt;
    }

    System.out.println(time);

}
</code></pre>
</div><div class="api-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Velocity_Verlet</span><span class="hljs-params">(Simulation)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        self.obj.pos += self.obj.vel * self.dt + <span class="hljs-number">0.5</span> * self.obj.acc * self.dt * self.dt
        self.obj.vel += self.obj.acc * self.dt
</code></pre>
</div><div class="api-method-sample" data-lang="hs" data-name="Haskell"><p>Unfortunately, this has not yet been implemented in haskell, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here&apos;s Julia code:</p>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>
</code></pre>
</div><div class="api-method-sample" data-lang="javascript" data-name="JavaScript"><pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">velocity_verlet</span>(<span class="hljs-params">pos, acc, dt</span>)</span>{

    <span class="hljs-keyword">var</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt;
        vel += acc*dt;
    }

   <span class="hljs-keyword">return</span> time;

}
</code></pre>
</div><div class="api-method-sample" data-lang="rs" data-name="Rust"><pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">velocity_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vel = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, time);
}
</code></pre>
</div></div></div>


<p>Even though this method is more used than the simple Verlet method mentioned above, it unforunately has an error term of <script type="math/tex; ">\mathcal{O} \Delta t^2</script>, which is two orders of magnitude worse. That said, if you want to have a simulaton with many objects that depend on one another --- like a gravity simulation --- the Velocity Verlet algorithm is a handy choice; however, you may have to play further tricks to allow everything to scale appropriately. These types of simulatons are sometimes called <em>n-body</em> simulations and one such trick is the <a href="barnes_hut.md">Barnes-Hut</a> algorithm, which cuts the complexity of n-body simulations from <script type="math/tex; ">\sim \mathcal{O}(n^2)</script> to <script type="math/tex; ">\sim \mathcal{O}(n\log(n))</script></p>
<h1 id="example-code">Example Code</h1>
<p>Both of these methods work simply by iterating timestep-by-timestep and can be written straightforwardly in any language. For reference, here are snippets of code that use both the classic and velocity Verlet methods to find the time it takes for a ball to hit the ground after being dropped from a given height.</p>
<div class="api-method"><div class="api-method-definition"></div><div class="api-method-code"><div class="api-method-sample" data-lang="jl" data-name="Julia"><h3 id="julia">Julia</h3>
<pre><code class="lang-julia"><span class="hljs-keyword">function</span> verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> stormer_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        temp_pos = pos
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt
        prev_pos = temp_pos

        <span class="hljs-comment"># Because acceleration is constant, velocity is straightforward</span>
        vel += acc*dt
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> velocity_verlet(pos<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, acc<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>, dt<span class="hljs-type">::</span><span class="hljs-built_in">Float64</span>)
    prev_pos = pos
    time = <span class="hljs-number">0.0</span>
    vel = <span class="hljs-number">0.0</span>

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0.0</span>)
        time += dt
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    <span class="hljs-keyword">end</span>

    println(time)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> main()
    verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
<span class="hljs-keyword">end</span>

main()
</code></pre>
</div><div class="api-method-sample" data-lang="cpp" data-name="C++"><h3 id="c">C++</h3>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>

<span class="hljs-comment">// Simple function for velocity-verlet</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
  <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
  prev_pos = pos;
  time = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    temp_pos = pos;
    pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = temp_pos;
  }

  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;
}

<span class="hljs-comment">// Simple function for stormer-verlet</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
  <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
  prev_pos = pos;
  vel = <span class="hljs-number">0</span>;
  time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    temp_pos = pos;
    pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
    prev_pos = temp_pos;

    <span class="hljs-comment">// The acceleration is constant, so the velocity is straightforward</span>
    vel += acc * dt;
  }

  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{

  <span class="hljs-keyword">double</span> time, vel;
  vel = <span class="hljs-number">0</span>;
  time = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
    time += dt;
    pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
    vel += acc * dt;
  }

  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{

  <span class="hljs-comment">// Note that depending on the simulation, you might want to have the verlet</span>
  <span class="hljs-comment">// loop outside.</span>

  <span class="hljs-comment">// For example, if your acceleration chages as a function of time, you might</span>
  <span class="hljs-comment">// need to also change the acceleration to be read into each of these</span>
  <span class="hljs-comment">// functions</span>
  verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
  stormer_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
  velocity_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
}
</code></pre>
</div><div class="api-method-sample" data-lang="c" data-name="C"><h3 id="c">C</h3>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
    prev_pos = pos;
    time = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, time);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        temp_pos = pos;
        pos = pos * <span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        vel += acc * dt;
    }

   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, time);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span> </span>{
    <span class="hljs-keyword">double</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>) {
        time += dt;
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    }

   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, time);
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
    stormer_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);
    velocity_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
</div><div class="api-method-sample" data-lang="java" data-name="Java"><h3 id="java">Java</h3>
<pre><code class="lang-java"><span class="hljs-comment">// Submitted by lolatomroflsinnlos</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span></span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time;
    prev_pos = pos;
    time = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    System.out.println(time);

}

<span class="hljs-comment">// Simple function for stormer-verlet</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stormer_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span></span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

       <span class="hljs-comment">// The acceleration is constant, so the velocity is straightforward</span>
       vel += acc*dt;
    }

    System.out.println(time);

}

<span class="hljs-comment">// Simple function for velocity-verlet</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">velocity_verlet</span><span class="hljs-params">(<span class="hljs-keyword">double</span> pos, <span class="hljs-keyword">double</span> acc, <span class="hljs-keyword">double</span> dt)</span></span>{

    <span class="hljs-comment">// Note that we are using a temp variable for the previous position</span>
    <span class="hljs-keyword">double</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt;
        vel += acc*dt;
    }

    System.out.println(time);

}

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{

    verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0.01</span>);
    stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0.01</span>);
    velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">0.01</span>);

}
</code></pre>
</div><div class="api-method-sample" data-lang="py" data-name="Python"><h3 id="python">Python</h3>
<pre><code class="lang-python"><span class="hljs-comment"># KingFredrickVI</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ball</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pos=<span class="hljs-number">0</span>, vel=<span class="hljs-number">0</span>, acc=<span class="hljs-number">0</span>)</span>:</span>
        self.pos = pos
        self.vel = vel
        self.acc = acc


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Simulation</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, obj, dt = <span class="hljs-number">0.01</span>)</span>:</span>
        self.obj = obj
        self.dt = dt
        self.prev_pos = self.obj.pos

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span><span class="hljs-params">(self)</span>:</span>
        self.time = <span class="hljs-number">0</span>

        <span class="hljs-keyword">while</span> self.obj.pos &gt; <span class="hljs-number">0</span>:
            self.time += self.dt
            self.step()

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">pass</span>


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Verlet</span><span class="hljs-params">(Simulation)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        temp_pos = self.obj.pos
        self.obj.pos = self.obj.pos * <span class="hljs-number">2</span> - self.prev_pos + self.obj.acc * self.dt * self.dt
        self.prev_pos = temp_pos

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Stormer_Verlet</span><span class="hljs-params">(Simulation)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        temp_pos = self.obj.pos
        self.obj.pos = self.obj.pos * <span class="hljs-number">2</span> - self.prev_pos + self.obj.acc * self.dt * self.dt
        self.prev_pos = temp_pos

        self.obj.vel += self.obj.acc * self.dt

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Velocity_Verlet</span><span class="hljs-params">(Simulation)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(self)</span>:</span>
        self.obj.pos += self.obj.vel * self.dt + <span class="hljs-number">0.5</span> * self.obj.acc * self.dt * self.dt
        self.obj.vel += self.obj.acc * self.dt


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
    sim = Verlet(Ball(pos = <span class="hljs-number">5.0</span>, acc = <span class="hljs-number">-10</span>))
    sim.run()

    print(<span class="hljs-string">&quot;Verlet:&quot;</span>, sim.time)

    sim = Stormer_Verlet(Ball(pos = <span class="hljs-number">5.0</span>, acc = <span class="hljs-number">-10</span>))
    sim.run()

    print(<span class="hljs-string">&quot;Stormer Verlet:&quot;</span>, sim.time)

    sim = Velocity_Verlet(Ball(pos = <span class="hljs-number">5.0</span>, acc = <span class="hljs-number">-10</span>))
    sim.run()

    print(<span class="hljs-string">&quot;Velocity Verlet:&quot;</span>, sim.time)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
    main()
</code></pre>
</div><div class="api-method-sample" data-lang="hs" data-name="Haskell"><h3 id="haskell">Haskell</h3>
<pre><code class="lang-haskell"><span class="hljs-comment">-- submitted by Jie</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Position</span>     = [<span class="hljs-type">Double</span>]</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Speed</span>        = [<span class="hljs-type">Double</span>]</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Time</span>         = <span class="hljs-type">Double</span></span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Particle</span>     = (<span class="hljs-type">Position</span>, <span class="hljs-type">Speed</span>, <span class="hljs-type">Acceleration</span>, <span class="hljs-type">Time</span>)</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Acceleration</span> = [<span class="hljs-type">Double</span>]</span>

<span class="hljs-title">verletStep</span> :: (<span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Acceleration</span>)
              -&gt; <span class="hljs-type">Time</span>
              -&gt; <span class="hljs-type">Particle</span>
              -&gt; <span class="hljs-type">Particle</span>
              -&gt; <span class="hljs-type">Particle</span>
<span class="hljs-title">verletStep</span> acc dt (xOld, _, aOld, _) (x, v, a, t) = (x&apos;, v&apos;, a&apos;, t+dt)
  <span class="hljs-keyword">where</span>
  x&apos; = zipWith3 (\xOld x a -&gt; <span class="hljs-number">2</span>*x - xOld + a*dt^<span class="hljs-number">2</span> ) xOld x a
  v&apos; = zipWith3 (\v a aOld -&gt; v + <span class="hljs-number">0.5</span>*(aOld + a)*dt) v a aOld
  a&apos; = acc (x&apos;, v&apos;, [], t+dt)

<span class="hljs-title">trajectory</span> :: (<span class="hljs-type">Particle</span> -&gt; <span class="hljs-type">Acceleration</span>)
              -&gt; <span class="hljs-type">Time</span>
              -&gt; <span class="hljs-type">Particle</span>
              -&gt; [<span class="hljs-type">Particle</span>]
<span class="hljs-title">trajectory</span> acc dt p0@(x, v, a, t0) = t
  <span class="hljs-keyword">where</span>
  t  = p0 : p1 : zipWith (verletStep acc dt) t (tail t)
  p1 = (x&apos;, v&apos;, acc (x&apos;, v&apos;, [], t0+dt), t0+dt)
  x&apos; = zipWith3 (\x v a -&gt; x + v*dt + <span class="hljs-number">0.5</span>*a*dt^<span class="hljs-number">2</span> ) x v a
  v&apos; = zipWith (\v a -&gt; v + a*dt) v a

<span class="hljs-title">freeFall</span> :: <span class="hljs-type">Particle</span>
<span class="hljs-title">freeFall</span> = last $ takeWhile (\([x],_,_,_) -&gt; x &gt; <span class="hljs-number">0</span>) $ trajectory acc dt p0
  <span class="hljs-keyword">where</span>
  p0    = ([<span class="hljs-number">5</span>], [<span class="hljs-number">0</span>], [<span class="hljs-number">-10</span>], <span class="hljs-number">0</span>)
  dt    = <span class="hljs-number">0.001</span>
  acc _ = [<span class="hljs-number">-10</span>]
</code></pre>
</div><div class="api-method-sample" data-lang="scratch" data-name="Scratch"><h3 id="scratch">Scratch</h3>
<p>Submitted by Jie</p>
<p></p><p>
    <img class="center" src="code/scratch/verlet_scratch.png">
</p>
Link: <a href="https://scratch.mit.edu/projects/173039394/" target="_blank">https://scratch.mit.edu/projects/173039394/</a><p></p>
</div><div class="api-method-sample" data-lang="matlab" data-name="Matlab"><h3 id="matlab">Matlab</h3>
<pre><code class="lang-matlab"><span class="hljs-comment">% Submitted by P. Mekhail</span>
<span class="hljs-comment">% Parameters to change</span>
n = <span class="hljs-number">400</span>;        <span class="hljs-comment">% Number of steps</span>
x0 = <span class="hljs-number">5</span>;         <span class="hljs-comment">% Ball starting height(in metres)</span>
v0 = <span class="hljs-number">0</span>;         <span class="hljs-comment">% Ball starting velocity (+ive is up)</span>
dt = <span class="hljs-number">0.01</span>;      <span class="hljs-comment">% Time step (in seconds)</span>
eff = <span class="hljs-number">0.4</span>;      <span class="hljs-comment">% Ball efficency when bouncing</span>
A = @(x) <span class="hljs-number">-10</span>;   <span class="hljs-comment">% Acceleration as a function of position</span>
bounce = <span class="hljs-number">1</span>;     <span class="hljs-comment">% Do you want the ball to bounce?</span>

<span class="hljs-comment">% Making position and time vectors</span>
x = <span class="hljs-built_in">zeros</span>(n,<span class="hljs-number">1</span>);
t = <span class="hljs-number">0</span>:dt:n*dt-dt;

<span class="hljs-comment">% Setting the initial conditions</span>
x(<span class="hljs-number">1</span>) = x0;
x(<span class="hljs-number">2</span>) = x0 + v0*dt + <span class="hljs-number">0.5</span>*A(x0)*dt^<span class="hljs-number">2</span>;

<span class="hljs-comment">% Runnin Verlet Integration</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span> = <span class="hljs-number">2</span>:n<span class="hljs-number">-1</span>
    xnew = <span class="hljs-number">2</span>*x(<span class="hljs-built_in">i</span>)-x(<span class="hljs-built_in">i</span><span class="hljs-number">-1</span>)+A(x(<span class="hljs-built_in">i</span>))*dt^<span class="hljs-number">2</span>;
    <span class="hljs-keyword">if</span> bounce
        <span class="hljs-keyword">if</span> xnew &gt; <span class="hljs-number">0</span>
            <span class="hljs-comment">% If you haven&apos;t hit the ground keep going</span>
            x(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = xnew;
        <span class="hljs-keyword">else</span>
            <span class="hljs-comment">% If you have calculated velocity and invert its sign</span>
            v = <span class="hljs-built_in">sqrt</span>(eff)*(xnew-x(<span class="hljs-built_in">i</span><span class="hljs-number">-1</span>))/(<span class="hljs-number">2</span>*dt);
            x(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = x(<span class="hljs-built_in">i</span>) - v*dt + <span class="hljs-number">0.5</span>*A(x(<span class="hljs-built_in">i</span>))*dt^<span class="hljs-number">2</span>;
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">else</span>
        x(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = xnew;
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
plot(t,x)
title(<span class="hljs-string">&apos;Ball&apos;&apos;s Trajectory&apos;</span>)
xlabel(<span class="hljs-string">&apos;Time (s)&apos;</span>); ylabel(<span class="hljs-string">&apos;Height (m)&apos;</span>);
</code></pre>
</div><div class="api-method-sample" data-lang="LabVIEW" data-name="LabVIEW"><h3 id="labview">LabVIEW</h3>
<p>Submitted by P. Mekhail</p>
<p>
    <img class="center" src="code/labview/verlet_labview.png">
</p></div><div class="api-method-sample" data-lang="javascript" data-name="JavaScript"><h3 id="javascript">JavaScript</h3>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verlet</span>(<span class="hljs-params">pos, acc, dt</span>)</span>{

    <span class="hljs-keyword">var</span> prev_pos, temp_pos, time;
    prev_pos = pos;
    time = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

   <span class="hljs-keyword">return</span> time;

}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stormer_verlet</span>(<span class="hljs-params">pos, acc, dt</span>)</span>{

    <span class="hljs-keyword">var</span> prev_pos, temp_pos, time, vel;
    prev_pos = pos;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        temp_pos = pos;
        pos = pos*<span class="hljs-number">2</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;

        vel += acc*dt;
    }

   <span class="hljs-keyword">return</span> time;

}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">velocity_verlet</span>(<span class="hljs-params">pos, acc, dt</span>)</span>{

    <span class="hljs-keyword">var</span> time, vel;
    vel = <span class="hljs-number">0</span>;
    time = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (pos &gt; <span class="hljs-number">0</span>){
        time += dt;
        pos += vel*dt + <span class="hljs-number">0.5</span>*acc * dt * dt;
        vel += acc*dt;
    }

   <span class="hljs-keyword">return</span> time;

}

<span class="hljs-built_in">console</span>.log(verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>));
<span class="hljs-built_in">console</span>.log(stormer_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>));
<span class="hljs-built_in">console</span>.log(velocity_verlet(<span class="hljs-number">5.0</span>, <span class="hljs-number">-10</span>, <span class="hljs-number">0.01</span>));
</code></pre>
</div><div class="api-method-sample" data-lang="rs" data-name="Rust"><h3 id="rust">Rust</h3>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, time);
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">stormer_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> prev_pos = pos;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        <span class="hljs-keyword">let</span> temp_pos = pos;
        pos = pos * <span class="hljs-number">2.0</span> - prev_pos + acc * dt * dt;
        prev_pos = temp_pos;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, time);
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">velocity_verlet</span></span>(<span class="hljs-keyword">mut</span> pos: <span class="hljs-keyword">f64</span>, acc: <span class="hljs-keyword">f64</span>, dt: <span class="hljs-keyword">f64</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> time = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vel = <span class="hljs-number">0.0</span>;

    <span class="hljs-keyword">while</span> pos &gt; <span class="hljs-number">0.0</span> {
        time += dt;
        pos += vel * dt + <span class="hljs-number">0.5</span> * acc * dt * dt;
        vel += acc * dt;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, time);
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    stormer_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
    velocity_verlet(<span class="hljs-number">5.0</span>, -<span class="hljs-number">10.0</span>, <span class="hljs-number">0.01</span>);
}
</code></pre>
</div></div></div>


<p><script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>
<script type="math/tex; mode=display">
\newcommand{\d}{\mathrm{d}}
\newcommand{\bff}{\boldsymbol{f}}
\newcommand{\bfg}{\boldsymbol{g}}
\newcommand{\bfp}{\boldsymbol{p}}
\newcommand{\bfq}{\boldsymbol{q}}
\newcommand{\bfx}{\boldsymbol{x}}
\newcommand{\bfu}{\boldsymbol{u}}
\newcommand{\bfv}{\boldsymbol{v}}
\newcommand{\bfA}{\boldsymbol{A}}
\newcommand{\bfB}{\boldsymbol{B}}
\newcommand{\bfC}{\boldsymbol{C}}
\newcommand{\bfM}{\boldsymbol{M}}
\newcommand{\bfJ}{\boldsymbol{J}}
\newcommand{\bfR}{\boldsymbol{R}}
\newcommand{\bfT}{\boldsymbol{T}}
\newcommand{\bfomega}{\boldsymbol{\omega}}
\newcommand{\bftau}{\boldsymbol{\tau}}
</script></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Verlet Integration","level":"1.19.1","depth":2,"next":{"title":"Barnes-Hut","level":"1.19.2","depth":2,"path":"chapters/physics_solvers/barnes_hut.md","ref":"chapters/physics_solvers/barnes_hut.md","articles":[]},"previous":{"title":"Physics Solvers","level":"1.19","depth":1,"path":"chapters/physics_solvers/physics_solvers.md","ref":"chapters/physics_solvers/physics_solvers.md","articles":[{"title":"Verlet Integration","level":"1.19.1","depth":2,"path":"chapters/physics_solvers/verlet/verlet.md","ref":"chapters/physics_solvers/verlet/verlet.md","articles":[]},{"title":"Barnes-Hut","level":"1.19.2","depth":2,"path":"chapters/physics_solvers/barnes_hut.md","ref":"chapters/physics_solvers/barnes_hut.md","articles":[]},{"title":"Quantum Systems","level":"1.19.3","depth":2,"path":"chapters/physics_solvers/quantum/quantum.md","ref":"chapters/physics_solvers/quantum/quantum.md","articles":[{"title":"Split-Operator Method","level":"1.19.3.1","depth":3,"path":"chapters/physics_solvers/quantum/split-op/split-op.md","ref":"chapters/physics_solvers/quantum/split-op/split-op.md","articles":[]}]}]},"dir":"ltr"},"config":{"plugins":["fontsettings","mathjax","bibtex-cite","creativecommons","wordcount","api-language-selector","include-codeblock","ga"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"pseudo","name":"Pseudocode"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"}]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"highlight":{},"bibtex-cite":{},"creativecommons":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"ga":{"configuration":"auto","token":"UA-118252470-1"},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}}],"gitbook":"3.x.x"},"file":{"path":"chapters/physics_solvers/verlet/verlet.md","mtime":"2018-07-05T20:26:37.327Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-07-05T20:43:33.750Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    

    </body>
</html>

