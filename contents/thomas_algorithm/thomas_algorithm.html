
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Thomas Algorithm Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../computational_geometry/computational_geometry.html" />
    
    
    <link rel="prev" href="../gaussian_elimination/gaussian_elimination.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../convolutions/convolutions.html">
            
                <a href="../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../sorting_and_searching/sorting_and_searching.html">
            
                <a href="../sorting_and_searching/sorting_and_searching.html">
            
                    
                    Sorting and Searching
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../bubble_sort/bubble_sort.html">
            
                <a href="../bubble_sort/bubble_sort.html">
            
                    
                    Bubble Sort
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../bogo_sort/bogo_sort.html">
            
                <a href="../bogo_sort/bogo_sort.html">
            
                    
                    Bogo Sort
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="../gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.10.2" data-path="thomas_algorithm.html">
            
                <a href="thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="../cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../differential_equations/differential_equations.html">
            
                <a href="../differential_equations/differential_equations.html">
            
                    
                    Differential Equation Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../forward_euler_method/forward_euler_method.html">
            
                <a href="../forward_euler_method/forward_euler_method.html">
            
                    
                    Forward Euler Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../verlet_integration/verlet_integration.html">
            
                <a href="../verlet_integration/verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Thomas Algorithm</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="thomas-algorithm">Thomas Algorithm</h1>
<p>As alluded to in the <a href="../gaussian_elimination/gaussian_elimination.html">Gaussian Elimination chapter</a>, the Thomas Algorithm (or TDMA, Tri-Diagonal Matrix Algorithm) allows for programmers to <strong>massively</strong> cut the computational cost of their code from <script type="math/tex; "> O(n^3)</script> to <script type="math/tex; ">O(n)</script> in certain cases!
This is done by exploiting a particular case of Gaussian Elimination where the matrix looks like this:</p>
<p><script type="math/tex; mode=display">
\left[
    \begin{array}{ccccc|c}
        b_0 & c_0 & & & & d_0 \\
        a_1 & b_1 & c_1 & & & d_1 \\
        & a_2 & \ddots & & & \vdots \\
        & & & & c_{n-1}& d_{n-1} \\
        & & & a_n & b_n & d_n
    \end{array}
\right]
</script></p>
<p>This matrix shape is called <em>Tri-Diagonal</em> (excluding the right-hand side of our system of equations, of course!).
Now, at first, it might not be obvious how this helps. Well, firstly, it makes the system easier to encode: we may divide it into four separate vectors corresponding to <script type="math/tex; ">a</script>, <script type="math/tex; ">b</script>, <script type="math/tex; ">c</script>, and <script type="math/tex; ">d</script> (in some implementations, you will see the missing <script type="math/tex; ">a_0</script> and <script type="math/tex; ">c_n</script> set to zero to get four vectors of the same size).
Secondly, and most importantly, equations this short and regular are easy to solve analytically.</p>
<p>We&apos;ll start by applying mechanisms familiar to those who have read the <a href="../gaussian_elimination/gaussian_elimination.html">Gaussian Elimination</a> chapter.
Our first goal is to eliminate the <script type="math/tex; ">a_i</script> terms and set the diagonal values <script type="math/tex; ">b_i</script> to <script type="math/tex; ">1</script>. The <script type="math/tex; ">c_i</script> and <script type="math/tex; ">d_i</script> terms will be transformed into <script type="math/tex; ">c'_i</script> and <script type="math/tex; ">d'_i</script>.
The first row is particularly easy to transform since there is no <script type="math/tex; ">a_0</script>, we simply need to divide the row by <script type="math/tex; ">b_0</script>:</p>
<p><script type="math/tex; mode=display">
\left\{
\begin{align}
c'_0 &= \frac{c_0}{b_0} \\
d'_0 &= \frac{d_0}{b_0}
\end{align}
\right.
</script></p>
<p>Let&apos;s assume that we found a way to transform the first <script type="math/tex; ">i-1</script> rows. How would we transform the next one? We have</p>
<p><script type="math/tex; mode=display">
\begin{array}{ccccccc|c}
    &  & \ddots & & & & &  \\
(i-1) & & 0 & 1 & c'_{i-1} & & & d'_{i-1} \\
(i)   & &   & a_i & b_i & c_i & & d_i \\
      & &   &   &   &  \ddots &  &
\end{array}
</script></p>
<p>Let&apos;s transform row <script type="math/tex; ">(i)</script> in two steps.</p>
<p><strong>Step one</strong>: eliminate <script type="math/tex; ">a_i</script> with the transformation <script type="math/tex; ">(i)^* = (i) - a_i \times (i-1)</script>:</p>
<p><script type="math/tex; mode=display">
\left\{
\begin{align}
a^*_i &= 0 \\
b^*_i &= b_i - a_i \times c'_{i-1} \\
c^*_i &= c_i \\
d^*_i &= d_i - a_i \times d'_{i-1}
\end{align}
\right.
</script></p>
<p><strong>Step two</strong>: get <script type="math/tex; ">b'_i=1</script> with the transformation <script type="math/tex; ">(i)' = (i)^* / b^*_i </script>:</p>
<p><script type="math/tex; mode=display">
\left\{
\begin{align}
a'_i &= 0 \\
b'_i &= 1 \\
c'_i &= \frac{c_i}{b_i - a_i \times c'_{i-1}} \\
d'_i &= \frac{d_i - a_i \times d'_{i-1}}{b_i - a_i \times c'_{i-1}}
\end{align}
\right.
</script></p>
<p>Brilliant! With the last two formula, we can calculate all the <script type="math/tex; ">c'_i</script> and <script type="math/tex; ">d'_i</script> in a single pass, starting from row <script type="math/tex; ">1</script>, since we already know the values of <script type="math/tex; ">c'_0</script> and <script type="math/tex; ">d'_0</script>.</p>
<p>Of course, what we really need are the solutions <script type="math/tex; ">x_i</script>. It&apos;s back substitution time!</p>
<p>If we express our system in terms of equations instead of a matrix, we get</p>
<p><script type="math/tex; mode=display">
x_i + c'_i \times x_{i+1} = d'_i
</script></p>
<p>plus the last row that is even simpler: <script type="math/tex; ">x_n = d'_n</script>. One solution for free!
Maybe we can backtrack from the last solution? Let&apos;s (barely) transform the above equation:</p>
<p><script type="math/tex; mode=display">
x_i = d'_i - c'_i \times x_{i+1}
</script></p>
<p>and that&apos;s all there is to it. We can calculate all the <script type="math/tex; ">x_i</script> in a single pass starting from the end.</p>
<p>Overall, we only need two passes, and that&apos;s why our algorithm is <script type="math/tex; ">O(n)</script>!
The transformations are quite easy too, isn&apos;t that neat?</p>
<h2 id="example-code">Example Code</h2>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre><code class="lang-julia"><span class="hljs-keyword">function</span> thomas(a<span class="hljs-type">::</span><span class="hljs-built_in">Vector</span>{<span class="hljs-built_in">Float64</span>}, b<span class="hljs-type">::</span><span class="hljs-built_in">Vector</span>{<span class="hljs-built_in">Float64</span>}, c<span class="hljs-type">::</span><span class="hljs-built_in">Vector</span>{<span class="hljs-built_in">Float64</span>},
                d<span class="hljs-type">::</span><span class="hljs-built_in">Vector</span>{<span class="hljs-built_in">Float64</span>}, n<span class="hljs-type">::</span><span class="hljs-built_in">Int64</span>)

    x = copy(d)
    c_prime = copy(c)

    <span class="hljs-comment"># Setting initial elements</span>
    c_prime[<span class="hljs-number">1</span>] /= b[<span class="hljs-number">1</span>]
    x[<span class="hljs-number">1</span>] /= b[<span class="hljs-number">1</span>]

    <span class="hljs-keyword">for</span> i = <span class="hljs-number">2</span>:n
        <span class="hljs-comment"># Scale factor is for c_prime and x</span>
        scale = <span class="hljs-number">1.0</span> / (b[i] - c_prime[i-<span class="hljs-number">1</span>]*a[i])
        c_prime[i] *= scale
        x[i] = (x[i] - a[i] * x[i-<span class="hljs-number">1</span>]) * scale
    <span class="hljs-keyword">end</span>

    <span class="hljs-comment"># Back-substitution</span>
    <span class="hljs-keyword">for</span> i = n-<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>:<span class="hljs-number">1</span>
        x[i] -= (c_prime[i] * x[i+<span class="hljs-number">1</span>])
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> x

<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> main()
    a = [<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>]
    b = [<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>]
    c = [<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>]
    d = [<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>]

    println(
        <span class="hljs-string">&quot;&quot;&quot;The system
        <span class="hljs-subst">$(join((b[<span class="hljs-number">1</span>], c[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;&quot;</span>,   <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">1</span>])</span>, &quot;\t&quot;))
        <span class="hljs-subst">$(join((a[<span class="hljs-number">2</span>], b[<span class="hljs-number">2</span>], c[<span class="hljs-number">2</span>], <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">2</span>])</span>, &quot;\t&quot;))
        <span class="hljs-subst">$(join((<span class="hljs-string">&quot;&quot;</span>,   a[<span class="hljs-number">3</span>], b[<span class="hljs-number">3</span>], <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">3</span>])</span>, &quot;\t&quot;))
        Has the solution:&quot;&quot;&quot;</span>
    )

    soln = thomas(a, b, c, d, <span class="hljs-number">3</span>)

    println(soln)
<span class="hljs-keyword">end</span>

main()
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre><code class="lang-cpp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void thomas(double * const a, double * const b, double * const c,
            double * const x, const size_t size) {

    double y[size];
    memset(y, 0, size * sizeof(double));

    y[0] = c[0] / b[0];
    x[0] = x[0] / b[0];

    for (size_t i = 1; i &lt; size; ++i) {
        double scale = 1.0 / (b[i] - a[i] * y[i - 1]);
        y[i] = c[i] * scale;
        x[i] = (x[i] - a[i] * x[i - 1]) * scale;
    }

    for (int i = size - 2; i &gt;= 0; --i) {
        x[i] -= y[i] * x[i + 1];
    }
}

int main() {
    double a[] = {0.0, 2.0, 3.0};
    double b[] = {1.0, 3.0, 6.0};
    double c[] = {4.0, 5.0, 0.0};
    double x[] = {7.0, 5.0, 3.0};

    printf(&quot;The system,\n&quot;);
    printf(&quot;[1.0  4.0  0.0][x] = [7.0]\n&quot;);
    printf(&quot;[2.0  3.0  5.0][y] = [5.0]\n&quot;);
    printf(&quot;[0.0  3.0  6.0][z] = [3.0]\n&quot;);
    printf(&quot;has the solution:\n&quot;);

    thomas(a, b, c, x, 3);

    for (size_t i = 0; i &lt; 3; ++i) {
        printf(&quot;[%f]\n&quot;, x[i]);
    }

    return 0;
}
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre><code class="lang-python"><span class="hljs-comment"># Author: gammison</span>

<span class="hljs-comment"># note this example is inplace and destructive</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">thomas</span><span class="hljs-params">(a, b, c, d)</span>:</span>

    <span class="hljs-comment"># set the initial elements</span>
    c[<span class="hljs-number">0</span>] = c[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>]
    d[<span class="hljs-number">0</span>] = d[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>]

    n = len(d) <span class="hljs-comment"># number of equations to solve</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, n):
        <span class="hljs-comment"># scale factor for c and d</span>
        scale = <span class="hljs-number">1</span> / (b[i] - c[i<span class="hljs-number">-1</span>] * a[i])

        c[i] *= scale
        d[i] = (d[i] - a[i] * d[i<span class="hljs-number">-1</span>]) * scale


    <span class="hljs-comment"># do the back substitution</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n<span class="hljs-number">-2</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>):
        d[i] -= c[i] * d[i+<span class="hljs-number">1</span>]

    <span class="hljs-keyword">return</span> d

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># example for matrix</span>
    <span class="hljs-comment"># [1  4  0][x]   [7]</span>
    <span class="hljs-comment"># [2  3  5][y] = [5]</span>
    <span class="hljs-comment"># [0  3  6][z]   [3]</span>

    <span class="hljs-comment">#                 [.8666]</span>
    <span class="hljs-comment"># soln will equal [1.533]</span>
    <span class="hljs-comment">#                 [-.266]</span>
    <span class="hljs-comment"># note we index a from 1 and c from 0</span>
    a = [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
    b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>]
    c = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>]
    d = [<span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]

    soln = thomas(a, b, c, d)
    print(soln)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:
    main()
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><p>You will find this algorithm implemented <a href="https://scratch.mit.edu/projects/169418273/" target="_blank">in this project</a>.</p>
<p>
  <img class="center" src="code/scratch/thomas.svg" width="1000">
</p></div><div class="code-method-sample" data-lang="java" data-name="Java"><pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Thomas</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span>[] thomasAlgorithm(<span class="hljs-keyword">double</span>[] a, <span class="hljs-keyword">double</span>[] b, <span class="hljs-keyword">double</span>[] c, <span class="hljs-keyword">double</span>[] x) {
        <span class="hljs-keyword">int</span> size = a.length;
        <span class="hljs-keyword">double</span>[] y = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[size]; <span class="hljs-comment">// This is needed so that we don&apos;t have to modify c</span>
        <span class="hljs-keyword">double</span>[] solution = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[size];

        <span class="hljs-comment">// Set initial elements</span>
        y[<span class="hljs-number">0</span>] = c[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>];
        solution[<span class="hljs-number">0</span>] = x[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; size; ++i) {
            <span class="hljs-comment">// Scale factor is for c and x</span>
            <span class="hljs-keyword">double</span> scale = <span class="hljs-number">1.0</span> / (b[i] - a[i] * y[i - <span class="hljs-number">1</span>]);
            y[i] = c[i] * scale;
            solution[i] = (x[i] - a[i] * solution[i - <span class="hljs-number">1</span>]) * scale;
        }

        <span class="hljs-comment">// Back-substitution</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = size - <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; --i) {
            solution[i] -= y[i] * solution[i + <span class="hljs-number">1</span>];
        }

        <span class="hljs-keyword">return</span> solution;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        <span class="hljs-keyword">double</span>[] a = {<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>};
        <span class="hljs-keyword">double</span>[] b = {<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>};
        <span class="hljs-keyword">double</span>[] c = {<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>};
        <span class="hljs-keyword">double</span>[] x = {<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>};
        <span class="hljs-keyword">double</span>[] solution = thomasAlgorithm(a, b, c, x);

        System.out.format(<span class="hljs-string">&quot;The system,\n&quot;</span>);
        System.out.format(<span class="hljs-string">&quot;[%.1f, %.1f, %.1f][x] = [%.1f]\n&quot;</span>, b[<span class="hljs-number">0</span>], c[<span class="hljs-number">0</span>], <span class="hljs-number">0f</span>, x[<span class="hljs-number">0</span>]);
        System.out.format(<span class="hljs-string">&quot;[%.1f, %.1f, %.1f][y] = [%.1f]\n&quot;</span>, a[<span class="hljs-number">1</span>], b[<span class="hljs-number">1</span>], c[<span class="hljs-number">1</span>], x[<span class="hljs-number">1</span>]);
        System.out.format(<span class="hljs-string">&quot;[%.1f, %.1f, %.1f][z] = [%.1f]\n&quot;</span>, <span class="hljs-number">0f</span>, a[<span class="hljs-number">2</span>], b[<span class="hljs-number">2</span>], x[<span class="hljs-number">2</span>]);
        System.out.format(<span class="hljs-string">&quot;has the solution:\n&quot;</span>);

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; solution.length; i++) {
            System.out.format(<span class="hljs-string">&quot;[% .5f]\n&quot;</span>, solution[i]);
        }
    }
}
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre><code class="lang-haskell"><span class="hljs-keyword">import</span> Data.List (<span class="hljs-title">zip4</span>)
<span class="hljs-keyword">import</span> Data.Ratio

<span class="hljs-title">thomas</span> :: <span class="hljs-type">Fractional</span> a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
<span class="hljs-title">thomas</span> a b c = init . scanr back <span class="hljs-number">0</span> . tail . scanl forward (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>) . zip4 a b c
  <span class="hljs-keyword">where</span>
    forward (c&apos;, d&apos;) (a, b, c, d) =
      <span class="hljs-keyword">let</span> denominator = b - a * c&apos;
       <span class="hljs-keyword">in</span> (c / denominator, (d - a * d&apos;) / denominator)
    back (c, d) x = d - c * x

<span class="hljs-title">main</span> :: <span class="hljs-type">IO</span> ()
<span class="hljs-title">main</span> = <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">let</span> a = [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] :: [<span class="hljs-type">Ratio</span> <span class="hljs-type">Int</span>]
      b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>]
      c = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>]
      d = [<span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]
  print $ thomas a b c d
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span>

<span class="hljs-keyword">func</span> thomas(a, b, c, d []<span class="hljs-keyword">float64</span>) []<span class="hljs-keyword">float64</span> {
    c[<span class="hljs-number">0</span>] = c[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>]
    d[<span class="hljs-number">0</span>] = d[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>]

    <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">len</span>(d); i++ {
        scale := <span class="hljs-number">1.</span> / (b[i] - c[i<span class="hljs-number">-1</span>]*a[i])
        c[i] *= scale
        d[i] = (d[i] - a[i]*d[i<span class="hljs-number">-1</span>]) * scale
    }

    <span class="hljs-keyword">for</span> i := <span class="hljs-built_in">len</span>(d) - <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; i-- {
        d[i] -= c[i] * d[i+<span class="hljs-number">1</span>]
    }

    <span class="hljs-keyword">return</span> d
}

<span class="hljs-keyword">func</span> main() {
    a := []<span class="hljs-keyword">float64</span>{<span class="hljs-number">0.</span>, <span class="hljs-number">2.</span>, <span class="hljs-number">3.</span>}
    b := []<span class="hljs-keyword">float64</span>{<span class="hljs-number">1.</span>, <span class="hljs-number">3.</span>, <span class="hljs-number">6.</span>}
    c := []<span class="hljs-keyword">float64</span>{<span class="hljs-number">4.</span>, <span class="hljs-number">5.</span>, <span class="hljs-number">0.</span>}
    d := []<span class="hljs-keyword">float64</span>{<span class="hljs-number">7.</span>, <span class="hljs-number">5.</span>, <span class="hljs-number">3.</span>}

    fmt.Println(<span class="hljs-string">&quot;The system,&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;[1.0  4.0  0.0][x] = [7.0]&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;[2.0  3.0  5.0][y] = [5.0]&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;[0.0  3.0  6.0][z] = [3.0]&quot;</span>)
    fmt.Println(<span class="hljs-string">&quot;has the solution:&quot;</span>)
    solve := thomas(a, b, c, d)
    <span class="hljs-keyword">for</span> _, i := <span class="hljs-keyword">range</span> solve {
        fmt.Printf(<span class="hljs-string">&quot;[%f]\n&quot;</span>, i)
    }
}
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">thomas</span><span class="hljs-params">(a: [Double], b: [Double], <span class="hljs-built_in">c</span>: [Double], d: [Double])</span></span> -&gt; [<span class="hljs-type">Double</span>] {
    <span class="hljs-keyword">var</span> a = a
    <span class="hljs-keyword">var</span> b = b
    <span class="hljs-keyword">var</span> <span class="hljs-built_in">c</span> = <span class="hljs-built_in">c</span>
    <span class="hljs-keyword">var</span> d = d

    <span class="hljs-comment">// set the initial elements</span>
    <span class="hljs-built_in">c</span>[<span class="hljs-number">0</span>] = <span class="hljs-built_in">c</span>[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>]
    d[<span class="hljs-number">0</span>] = d[<span class="hljs-number">0</span>] / b[<span class="hljs-number">0</span>]

    <span class="hljs-keyword">let</span> n = d.<span class="hljs-built_in">count</span> <span class="hljs-comment">// number of equations to solve</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..&lt;n {
        <span class="hljs-comment">// scale factor for c and d</span>
        <span class="hljs-keyword">let</span> scale = <span class="hljs-number">1</span> / (b[i] - <span class="hljs-built_in">c</span>[i-<span class="hljs-number">1</span>] * a[i])

        <span class="hljs-built_in">c</span>[i] = <span class="hljs-built_in">c</span>[i] * scale
        d[i] = (d[i] - a[i] * d[i-<span class="hljs-number">1</span>]) * scale
    }

    <span class="hljs-comment">// do the back substitution</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">stride</span>(from: n-<span class="hljs-number">2</span>, to: -<span class="hljs-number">1</span>, by: -<span class="hljs-number">1</span>) {
        d[i] = d[i] - <span class="hljs-built_in">c</span>[i] * d[i+<span class="hljs-number">1</span>]
    }

    <span class="hljs-keyword">return</span> d
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">let</span> a = [<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>]
    <span class="hljs-keyword">let</span> b = [<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>]
    <span class="hljs-keyword">let</span> <span class="hljs-built_in">c</span> = [<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>]
    <span class="hljs-keyword">let</span> d = [<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>]

    <span class="hljs-built_in">print</span>(thomas(a: a, b: b, <span class="hljs-built_in">c</span>: <span class="hljs-built_in">c</span>, d: d))
}

main()
</code></pre>
</div><div class="code-method-sample" data-lang="php" data-name="PHP"><pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">thomas_algorithm</span><span class="hljs-params">(array $a, array $b, array $c, array $x, int $size)</span>: <span class="hljs-title">array</span>
</span>{
    $y = [];
    $y[<span class="hljs-number">0</span>] = $b[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : $c[<span class="hljs-number">0</span>] / $b[<span class="hljs-number">0</span>];
    $x[<span class="hljs-number">0</span>] = $b[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : $x[<span class="hljs-number">0</span>] / $b[<span class="hljs-number">0</span>];

    <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">1</span>; $i &lt; $size; ++$i) {
        $scale = (float)(<span class="hljs-number">1</span> / ($b[$i] - $a[$i] * $y[$i - <span class="hljs-number">1</span>]));
        $y[$i] = $c[$i] * $scale;
        $x[$i] = ($x[$i] - $a[$i] * $x[$i - <span class="hljs-number">1</span>]) * $scale;
    }

    <span class="hljs-keyword">for</span> ($i = $size - <span class="hljs-number">2</span>; $i &gt;= <span class="hljs-number">0</span>; --$i)
        $x[$i] -= $y[$i] &amp; $x[$i + <span class="hljs-number">1</span>];

    <span class="hljs-keyword">return</span> $x;
}


$a = [<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>];
$b = [<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>];
$c = [<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>];
$x = [<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>];

printf(<span class="hljs-string">&apos;The system,%s&apos;</span>, PHP_EOL);
printf(<span class="hljs-string">&apos;  [%s, %s, %s][x] = [%s]%s&apos;</span>, $b[<span class="hljs-number">0</span>], $c[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>, $x[<span class="hljs-number">0</span>], PHP_EOL);
printf(<span class="hljs-string">&apos;  [%s, %s, %s][y] = [%s]%s&apos;</span>, $a[<span class="hljs-number">1</span>], $b[<span class="hljs-number">1</span>], $c[<span class="hljs-number">1</span>], $x[<span class="hljs-number">1</span>], PHP_EOL);
printf(<span class="hljs-string">&apos;  [%s, %s, %s][z] = [%s]%s&apos;</span>, <span class="hljs-number">0</span>, $a[<span class="hljs-number">2</span>], $b[<span class="hljs-number">2</span>], $x[<span class="hljs-number">2</span>], PHP_EOL);
printf(<span class="hljs-string">&apos;has the solution:%s&apos;</span>, PHP_EOL);

$solution = thomas_algorithm($a, $a, $c, $x, count($x));
<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; count($solution); $i++)
    printf(<span class="hljs-string">&apos;  [%s]%s&apos;</span>, $solution[$i], PHP_EOL);
</code></pre>
</div><div class="code-method-sample" data-lang="nim" data-name="Nim"><pre><code class="lang-nim"><span class="hljs-keyword">proc</span> thomas_algorithm(a, b, c_in, d_in: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>]): <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = 

  <span class="hljs-keyword">let</span> n: <span class="hljs-built_in">int</span> = len(d_in)

  <span class="hljs-keyword">var</span> c: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = c_in
  <span class="hljs-keyword">var</span> d: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = d_in

  c[<span class="hljs-number">0</span>] /= b[<span class="hljs-number">0</span>]
  d[<span class="hljs-number">0</span>] /= b[<span class="hljs-number">0</span>]

  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..n - <span class="hljs-number">1</span>:
    <span class="hljs-keyword">let</span> scale: <span class="hljs-built_in">float</span> = (<span class="hljs-number">1</span> / (b[i] - c[i - <span class="hljs-number">1</span>] * a[i]))

    c[i] *= scale
    d[i] = (d[i] - a[i] * d[i - <span class="hljs-number">1</span>]) * scale

  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> countdown(n - <span class="hljs-number">2</span>,<span class="hljs-number">0</span>):
    d[i] -= c[i] * d[i + <span class="hljs-number">1</span>]


  <span class="hljs-keyword">return</span> d


<span class="hljs-keyword">const</span> x: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = @[<span class="hljs-number">0</span>.<span class="hljs-number">0</span>, <span class="hljs-number">2</span>.<span class="hljs-number">0</span>, <span class="hljs-number">3</span>.<span class="hljs-number">0</span>]
<span class="hljs-keyword">const</span> y: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = @[<span class="hljs-number">1</span>.<span class="hljs-number">0</span>, <span class="hljs-number">3</span>.<span class="hljs-number">0</span>, <span class="hljs-number">6</span>.<span class="hljs-number">0</span>]
<span class="hljs-keyword">const</span> z: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = @[<span class="hljs-number">4</span>.<span class="hljs-number">0</span>, <span class="hljs-number">5</span>.<span class="hljs-number">0</span>, <span class="hljs-number">0</span>.<span class="hljs-number">0</span>]
<span class="hljs-keyword">const</span> w: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = @[<span class="hljs-number">7</span>.<span class="hljs-number">0</span>, <span class="hljs-number">5</span>.<span class="hljs-number">0</span>, <span class="hljs-number">3</span>.<span class="hljs-number">0</span>]            

echo <span class="hljs-string">&quot;The system,&quot;</span>
echo <span class="hljs-string">&quot;[1.0 4.0 0.0][x] = [7.0]&quot;</span>
echo <span class="hljs-string">&quot;[2.0 3.0 5.0][y] = [5.0]&quot;</span>
echo <span class="hljs-string">&quot;[0.0 3.0 6.0][z] = [3.0]&quot;</span>

echo <span class="hljs-string">&quot;has the solution:&quot;</span>

<span class="hljs-keyword">const</span> soln: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">float</span>] = thomas_algorithm(x, y, z, w)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..len(w) - <span class="hljs-number">1</span>:
  echo soln[i]
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre><code class="lang-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;cstring&gt;

void thomas(std::vector&lt;double&gt; const a, std::vector&lt;double&gt; const b, std::vector&lt;double&gt; const c, std::vector&lt;double&gt;&amp; x) {
    int size = a.size();
    double y[size];
    memset(y, 0, size * sizeof(double));

    y[0] = c[0] / b[0];
    x[0] = x[0] / b[0];

    for (size_t i = 1; i &lt; size; ++i) {
        double scale = 1.0 / (b[i] - a[i] * y[i - 1]);
        y[i] = c[i] * scale;
        x[i] = (x[i] - a[i] * x[i - 1]) * scale;
    }

    for (int i = size - 2; i &gt;= 0; --i) {
        x[i] -= y[i] * x[i + 1];
    }
}

int main() {
    std::vector&lt;double&gt; a = {0.0, 2.0, 3.0};
    std::vector&lt;double&gt; b = {1.0, 3.0, 6.0};
    std::vector&lt;double&gt; c = {4.0, 5.0, 0.0};
    std::vector&lt;double&gt; x = {7.0, 5.0, 3.0};

    std::cout &lt;&lt; &quot;The system&quot; &lt;&lt; std::endl; 
    std::cout &lt;&lt; &quot;[1.0  4.0  0.0][x] = [7.0]&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;[2.0  3.0  5.0][y] = [5.0]&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;[0.0  3.0  6.0][z] = [3.0]&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;has the solution&quot; &lt;&lt; std::endl;

    thomas(a, b, c, x);

    for (size_t i = 0; i &lt; 3; ++i) {
        std::cout &lt;&lt; &quot;[&quot; &lt;&lt; x[i] &lt;&lt; &quot;]&quot; &lt;&lt; std::endl;
    }

    return 0;
}
</code></pre>
</div><div class="code-method-sample" data-lang="lua" data-name="Lua"><pre><code class="lang-lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">thomas</span><span class="hljs-params">(a, b, c, d)</span></span>

  <span class="hljs-comment">-- Create tables and set initial elements</span>
  <span class="hljs-keyword">local</span> c_prime = {c[<span class="hljs-number">1</span>] / b[<span class="hljs-number">1</span>]}
  <span class="hljs-keyword">local</span> result = {d[<span class="hljs-number">1</span>] / b[<span class="hljs-number">1</span>]}

  <span class="hljs-keyword">for</span> i = <span class="hljs-number">2</span>, #a <span class="hljs-keyword">do</span>
    <span class="hljs-comment">-- Scale factor is for c_prime and result</span>
    <span class="hljs-keyword">local</span> scale = <span class="hljs-number">1.0</span> / (b[i] - a[i] * c_prime[i - <span class="hljs-number">1</span>])
    c_prime[i] = c[i] * scale
    result[i] = (d[i] - a[i] * result[i - <span class="hljs-number">1</span>]) * scale
  <span class="hljs-keyword">end</span>

  <span class="hljs-comment">-- Back-substitution</span>
  <span class="hljs-keyword">for</span> i = #a<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span> <span class="hljs-keyword">do</span>
    result[i] = result[i] - (c_prime[i] * result [i + <span class="hljs-number">1</span>])
  <span class="hljs-keyword">end</span>

  <span class="hljs-keyword">return</span> result
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> a = {<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>}
<span class="hljs-keyword">local</span> b = {<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>}
<span class="hljs-keyword">local</span> c = {<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>}
<span class="hljs-keyword">local</span> d = {<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>}

<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;The system&quot;</span>)
<span class="hljs-built_in">print</span>(b[<span class="hljs-number">1</span>], c[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;&quot;</span>,   <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">1</span>])
<span class="hljs-built_in">print</span>(a[<span class="hljs-number">2</span>], b[<span class="hljs-number">2</span>], c[<span class="hljs-number">2</span>], <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">2</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>,   a[<span class="hljs-number">3</span>], b[<span class="hljs-number">3</span>], <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">3</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Has the solution:&quot;</span>)

<span class="hljs-keyword">local</span> solution = thomas(a, b, c, d)

<span class="hljs-built_in">print</span>(<span class="hljs-built_in">table</span>.<span class="hljs-built_in">unpack</span>(solution))
</code></pre>
</div><div class="code-method-sample" data-lang="crystal" data-name="Crystal"><pre><code class="lang-crystal"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">thomas</span></span>(a, b, c, d)
  c_prime = c.dup
  x = d.dup

  <span class="hljs-comment"># Setting initial elements</span>
  c_prime[<span class="hljs-number">0</span>] /= b[<span class="hljs-number">0</span>]
  x[<span class="hljs-number">0</span>] /= b[<span class="hljs-number">0</span>]

  <span class="hljs-number">1</span>.upto(a.size - <span class="hljs-number">1</span>) <span class="hljs-keyword">do</span> |i|
    <span class="hljs-comment"># Scale factor is for c_prime and x</span>
    scale = <span class="hljs-number">1.0</span> / (b[i] - c_prime[i - <span class="hljs-number">1</span>]*a[i])
    c_prime[i] *= scale
    x[i] = (x[i] - a[i] * x[i - <span class="hljs-number">1</span>]) * scale
  <span class="hljs-keyword">end</span>

  <span class="hljs-comment"># Back-substitution</span>
  (a.size - <span class="hljs-number">2</span>).downto(<span class="hljs-number">0</span>) <span class="hljs-keyword">do</span> |i|
    x[i] -= (c_prime[i] * x[i + <span class="hljs-number">1</span>])
  <span class="hljs-keyword">end</span>

  x
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>
  a = [<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>]
  b = [<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>]
  c = [<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>]
  d = [<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>]

  puts <span class="hljs-string">&quot;The system&quot;</span>
  puts [b[<span class="hljs-number">0</span>], c[<span class="hljs-number">0</span>], <span class="hljs-string">&quot;&quot;</span>,   <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">0</span>]].join(<span class="hljs-string">&quot;\t&quot;</span>)
  puts [a[<span class="hljs-number">1</span>], b[<span class="hljs-number">1</span>], c[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">1</span>]].join(<span class="hljs-string">&quot;\t&quot;</span>)
  puts [<span class="hljs-string">&quot;&quot;</span>,   a[<span class="hljs-number">2</span>], b[<span class="hljs-number">2</span>], <span class="hljs-string">&quot;|&quot;</span>, d[<span class="hljs-number">2</span>]].join(<span class="hljs-string">&quot;\t&quot;</span>)
  puts <span class="hljs-string">&quot;Has the solution:&quot;</span>

  soln = thomas(a, b, c, d)

  puts soln.join(<span class="hljs-string">&quot;\t&quot;</span>)
<span class="hljs-keyword">end</span>

main
</code></pre>
</div><div class="code-method-sample" data-lang="kotlin" data-name="KOTLIN"><pre><code class="lang-kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">thomas</span><span class="hljs-params">(a: <span class="hljs-type">DoubleArray, b: DoubleArray, c: DoubleArray, d: DoubleArray</span>)</span>: DoubleArray {</span>
    <span class="hljs-variable"><span class="hljs-keyword">val</span> cPrime</span> = c.clone()
    <span class="hljs-variable"><span class="hljs-keyword">val</span> x</span> = d.clone()
    <span class="hljs-variable"><span class="hljs-keyword">val</span> size</span> = a.size
    cPrime[<span class="hljs-number">0</span>] /= b[<span class="hljs-number">0</span>]
    x[<span class="hljs-number">0</span>] /= b[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span> until size) {
        <span class="hljs-variable"><span class="hljs-keyword">val</span> scale</span> = <span class="hljs-number">1.0</span> / (b[i] - cPrime[i - <span class="hljs-number">1</span>] * a[i])
        cPrime[i] *= scale
        x[i] = (x[i] - a[i] * x[i - <span class="hljs-number">1</span>]) * scale
    }
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> (size - <span class="hljs-number">2</span>) downTo <span class="hljs-number">0</span>) {
        x[i] -= cPrime[i] * x[i + <span class="hljs-number">1</span>]
    }
    <span class="hljs-keyword">return</span> x
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array&lt;String&gt;</span>)</span> {</span>
    <span class="hljs-variable"><span class="hljs-keyword">val</span> a</span> = doubleArrayOf(<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>)
    <span class="hljs-variable"><span class="hljs-keyword">val</span> b</span> = doubleArrayOf(<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>)
    <span class="hljs-variable"><span class="hljs-keyword">val</span> c</span> = doubleArrayOf(<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">0.0</span>)
    <span class="hljs-variable"><span class="hljs-keyword">val</span> x</span> = doubleArrayOf(<span class="hljs-number">7.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">3.0</span>)
    <span class="hljs-variable"><span class="hljs-keyword">val</span> solution</span> = thomas(a, b, c, x)

    println(<span class="hljs-string">&quot;System:&quot;</span>)
    println(<span class="hljs-string">&quot;[%.1f, %.1f, %.1f][x] = [%.1f]&quot;</span>.format(b[<span class="hljs-number">0</span>], c[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>f, x[<span class="hljs-number">0</span>]))
    println(<span class="hljs-string">&quot;[%.1f, %.1f, %.1f][y] = [%.1f]&quot;</span>.format(a[<span class="hljs-number">1</span>], b[<span class="hljs-number">1</span>], c[<span class="hljs-number">1</span>], x[<span class="hljs-number">1</span>]))
    println(<span class="hljs-string">&quot;[%.1f, %.1f, %.1f][z] = [%.1f]\n&quot;</span>.format(<span class="hljs-number">0</span>f, a[<span class="hljs-number">2</span>], b[<span class="hljs-number">2</span>], x[<span class="hljs-number">2</span>]))
    println(<span class="hljs-string">&quot;Solution:&quot;</span>)
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> solution.indices) {
        println(<span class="hljs-string">&quot;[% .5f]&quot;</span>.format(solution[i]))
    }
}
</code></pre>
</div></div></div>

<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../gaussian_elimination/gaussian_elimination.html" class="navigation navigation-prev " aria-label="Previous page: Gaussian Elimination">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../computational_geometry/computational_geometry.html" class="navigation navigation-next " aria-label="Next page: Computational Geometry">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Thomas Algorithm","level":"1.10.2","depth":2,"next":{"title":"Computational Geometry","level":"1.11","depth":1,"path":"contents/computational_geometry/computational_geometry.md","ref":"contents/computational_geometry/computational_geometry.md","articles":[{"title":"Gift Wrapping","level":"1.11.1","depth":2,"path":"contents/gift_wrapping/gift_wrapping.md","ref":"contents/gift_wrapping/gift_wrapping.md","articles":[{"title":"Jarvis March","level":"1.11.1.1","depth":3,"path":"contents/jarvis_march/jarvis_march.md","ref":"contents/jarvis_march/jarvis_march.md","articles":[]},{"title":"Graham Scan","level":"1.11.1.2","depth":3,"path":"contents/graham_scan/graham_scan.md","ref":"contents/graham_scan/graham_scan.md","articles":[]}]}]},"previous":{"title":"Gaussian Elimination","level":"1.10.1","depth":2,"path":"contents/gaussian_elimination/gaussian_elimination.md","ref":"contents/gaussian_elimination/gaussian_elimination.md","articles":[]},"dir":"ltr"},"config":{"plugins":["fontsettings","mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","creativecommons","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","ga","bulk-redirect"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"}]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"highlight":{},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"creativecommons":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"ga":{"configuration":"auto","token":"UA-118252470-1"},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}}],"gitbook":"3.x.x"},"file":{"path":"contents/thomas_algorithm/thomas_algorithm.md","mtime":"2018-11-09T02:49:16.894Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-11-09T02:50:59.313Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    

    </body>
</html>

